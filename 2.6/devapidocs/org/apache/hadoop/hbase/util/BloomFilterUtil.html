<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (17) -->
<title>BloomFilterUtil (Apache HBase 2.6.0 API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="description" content="declaration: package: org.apache.hadoop.hbase.util, class: BloomFilterUtil">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/BloomFilterUtil.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html#class">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field-summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li><a href="#field-detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" value="search" disabled="disabled">
<input type="reset" id="reset-button" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">org.apache.hadoop.hbase.util</a></div>
<h1 title="Class BloomFilterUtil" class="title">Class BloomFilterUtil</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">org.apache.hadoop.hbase.util.BloomFilterUtil</div>
</div>
<section class="class-description" id="class-description">
<hr>
<div class="type-signature"><span class="annotations">@Private
</span><span class="modifiers">public final class </span><span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/util/BloomFilterUtil.html#line-34">BloomFilterUtil</a></span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span></div>
<div class="block">Utility methods related to BloomFilters</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- =========== FIELD SUMMARY =========== -->
<li>
<section class="field-summary" id="field-summary">
<h2>Field Summary</h2>
<div class="caption"><span>Fields</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Field</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>static final byte[]</code></div>
<div class="col-second even-row-color"><code><a href="#bitvals" class="member-name-link">bitvals</a></code></div>
<div class="col-last even-row-color">
<div class="block">Bit-value lookup array to prevent doing the same work over and over</div>
</div>
<div class="col-first odd-row-color"><code>static final double</code></div>
<div class="col-second odd-row-color"><code><a href="#LOG2_SQUARED" class="member-name-link">LOG2_SQUARED</a></code></div>
<div class="col-last odd-row-color">
<div class="block">Used in computing the optimal Bloom filter size.</div>
</div>
<div class="col-first even-row-color"><code>static final <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second even-row-color"><code><a href="#PREFIX_LENGTH_KEY" class="member-name-link">PREFIX_LENGTH_KEY</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>private static <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Random.html" title="class or interface in java.util" class="external-link">Random</a></code></div>
<div class="col-second odd-row-color"><code><a href="#randomGeneratorForTest" class="member-name-link">randomGeneratorForTest</a></code></div>
<div class="col-last odd-row-color">
<div class="block">A random number generator to use for "fake lookups" when testing to estimate the ideal false
 positive rate.</div>
</div>
<div class="col-first even-row-color"><code>static final <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second even-row-color"><code><a href="#STATS_RECORD_SEP" class="member-name-link">STATS_RECORD_SEP</a></code></div>
<div class="col-last even-row-color">
<div class="block">Record separator for the Bloom filter statistics human-readable string</div>
</div>
</div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier</div>
<div class="table-header col-second">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>private </code></div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E()" class="member-name-link">BloomFilterUtil</a>()</code></div>
<div class="col-last even-row-color">
<div class="block">Private constructor to keep this class from being instantiated.</div>
</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab1" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab1', 3)" class="table-tab">Static Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel" aria-labelledby="method-summary-table-tab0">
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static double</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#actualErrorRate(long,long,int)" class="member-name-link">actualErrorRate</a><wbr>(long&nbsp;maxKeys,
 long&nbsp;bitSize,
 int&nbsp;functionCount)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Computes the actual error rate for the given number of elements, number of bits, and number of
 hash functions.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>(package private) static boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#checkBit(int,org.apache.hadoop.hbase.nio.ByteBuff,int)" class="member-name-link">checkBit</a><wbr>(int&nbsp;pos,
 <a href="../nio/ByteBuff.html" title="class in org.apache.hadoop.hbase.nio">ByteBuff</a>&nbsp;bloomBuf,
 int&nbsp;bloomOffset)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Check if bit at specified index is 1.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static long</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#computeBitSize(long,double)" class="member-name-link">computeBitSize</a><wbr>(long&nbsp;maxKeys,
 double&nbsp;errorRate)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static int</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#computeFoldableByteSize(long,int)" class="member-name-link">computeFoldableByteSize</a><wbr>(long&nbsp;bitSize,
 int&nbsp;foldFactor)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Increases the given byte size of a Bloom filter until it can be folded by the given factor.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static long</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#computeMaxKeys(long,double,int)" class="member-name-link">computeMaxKeys</a><wbr>(long&nbsp;bitSize,
 double&nbsp;errorRate,
 int&nbsp;hashCount)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">The maximum number of keys we can put into a Bloom filter of a certain size to get the given
 error rate, with the given number of hash functions.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#contains(byte%5B%5D,int,int,org.apache.hadoop.hbase.nio.ByteBuff,int,int,org.apache.hadoop.hbase.util.Hash,int)" class="member-name-link">contains</a><wbr>(byte[]&nbsp;buf,
 int&nbsp;offset,
 int&nbsp;length,
 <a href="../nio/ByteBuff.html" title="class in org.apache.hadoop.hbase.nio">ByteBuff</a>&nbsp;bloomBuf,
 int&nbsp;bloomOffset,
 int&nbsp;bloomSize,
 <a href="Hash.html" title="class in org.apache.hadoop.hbase.util">Hash</a>&nbsp;hash,
 int&nbsp;hashCount)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">&nbsp;</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#contains(org.apache.hadoop.hbase.Cell,org.apache.hadoop.hbase.nio.ByteBuff,int,int,org.apache.hadoop.hbase.util.Hash,int,org.apache.hadoop.hbase.regionserver.BloomType)" class="member-name-link">contains</a><wbr>(<a href="../Cell.html" title="interface in org.apache.hadoop.hbase">Cell</a>&nbsp;cell,
 <a href="../nio/ByteBuff.html" title="class in org.apache.hadoop.hbase.nio">ByteBuff</a>&nbsp;bloomBuf,
 int&nbsp;bloomOffset,
 int&nbsp;bloomSize,
 <a href="Hash.html" title="class in org.apache.hadoop.hbase.util">Hash</a>&nbsp;hash,
 int&nbsp;hashCount,
 <a href="../regionserver/BloomType.html" title="enum in org.apache.hadoop.hbase.regionserver">BloomType</a>&nbsp;type)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>private static &lt;T&gt;&nbsp;boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#contains(org.apache.hadoop.hbase.nio.ByteBuff,int,int,org.apache.hadoop.hbase.util.Hash,int,org.apache.hadoop.hbase.util.HashKey)" class="member-name-link">contains</a><wbr>(<a href="../nio/ByteBuff.html" title="class in org.apache.hadoop.hbase.nio">ByteBuff</a>&nbsp;bloomBuf,
 int&nbsp;bloomOffset,
 int&nbsp;bloomSize,
 <a href="Hash.html" title="class in org.apache.hadoop.hbase.util">Hash</a>&nbsp;hash,
 int&nbsp;hashCount,
 <a href="HashKey.html" title="class in org.apache.hadoop.hbase.util">HashKey</a>&lt;T&gt;&nbsp;hashKey)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">&nbsp;</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="BloomFilterChunk.html" title="class in org.apache.hadoop.hbase.util">BloomFilterChunk</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#createBySize(int,double,int,int,org.apache.hadoop.hbase.regionserver.BloomType)" class="member-name-link">createBySize</a><wbr>(int&nbsp;byteSizeHint,
 double&nbsp;errorRate,
 int&nbsp;hashType,
 int&nbsp;foldFactor,
 <a href="../regionserver/BloomType.html" title="enum in org.apache.hadoop.hbase.regionserver">BloomType</a>&nbsp;bloomType)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Creates a Bloom filter chunk of the given size.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#formatStats(org.apache.hadoop.hbase.util.BloomFilterBase)" class="member-name-link">formatStats</a><wbr>(<a href="BloomFilterBase.html" title="interface in org.apache.hadoop.hbase.util">BloomFilterBase</a>&nbsp;bloomFilter)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">A human-readable string with statistics for the given Bloom filter.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static byte[]</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#getBloomFilterParam(org.apache.hadoop.hbase.regionserver.BloomType,org.apache.hadoop.conf.Configuration)" class="member-name-link">getBloomFilterParam</a><wbr>(<a href="../regionserver/BloomType.html" title="enum in org.apache.hadoop.hbase.regionserver">BloomType</a>&nbsp;bloomFilterType,
 org.apache.hadoop.conf.Configuration&nbsp;conf)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static long</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#idealMaxKeys(long,double)" class="member-name-link">idealMaxKeys</a><wbr>(long&nbsp;bitSize,
 double&nbsp;errorRate)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">The maximum number of keys we can put into a Bloom filter of a certain size to maintain the
 given error rate, assuming the number of hash functions is chosen optimally and does not even
 have to be an integer (hence the "ideal" in the function name).</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static int</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#optimalFunctionCount(int,long)" class="member-name-link">optimalFunctionCount</a><wbr>(int&nbsp;maxKeys,
 long&nbsp;bitSize)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#setRandomGeneratorForTest(java.util.Random)" class="member-name-link">setRandomGeneratorForTest</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/util/Random.html" title="class or interface in java.util" class="external-link">Random</a>&nbsp;random)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Sets a random generator to be used for look-ups instead of computing hashes.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#toString(org.apache.hadoop.hbase.util.BloomFilterChunk)" class="member-name-link">toString</a><wbr>(<a href="BloomFilterChunk.html" title="class in org.apache.hadoop.hbase.util">BloomFilterChunk</a>&nbsp;bloomFilter)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">&nbsp;</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#clone--" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#equals-java.lang.Object-" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#finalize--" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#getClass--" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#hashCode--" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#notify--" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#notifyAll--" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#toString--" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait--" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait-long-" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait-long-int-" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ FIELD DETAIL =========== -->
<li>
<section class="field-details" id="field-detail">
<h2>Field Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="STATS_RECORD_SEP">
<h3>STATS_RECORD_SEP</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/util/BloomFilterUtil.html#line-38">STATS_RECORD_SEP</a></span></div>
<div class="block">Record separator for the Bloom filter statistics human-readable string</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../constant-values.html#org.apache.hadoop.hbase.util.BloomFilterUtil.STATS_RECORD_SEP">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="LOG2_SQUARED">
<h3>LOG2_SQUARED</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/util/BloomFilterUtil.html#line-42">LOG2_SQUARED</a></span></div>
<div class="block">Used in computing the optimal Bloom filter size. This approximately equals 0.480453.</div>
</section>
</li>
<li>
<section class="detail" id="randomGeneratorForTest">
<h3>randomGeneratorForTest</h3>
<div class="member-signature"><span class="modifiers">private static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/Random.html" title="class or interface in java.util" class="external-link">Random</a></span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/util/BloomFilterUtil.html#line-48">randomGeneratorForTest</a></span></div>
<div class="block">A random number generator to use for "fake lookups" when testing to estimate the ideal false
 positive rate.</div>
</section>
</li>
<li>
<section class="detail" id="PREFIX_LENGTH_KEY">
<h3>PREFIX_LENGTH_KEY</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/util/BloomFilterUtil.html#line-50">PREFIX_LENGTH_KEY</a></span></div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../constant-values.html#org.apache.hadoop.hbase.util.BloomFilterUtil.PREFIX_LENGTH_KEY">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="bitvals">
<h3>bitvals</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/util/BloomFilterUtil.html#line-53">bitvals</a></span></div>
<div class="block">Bit-value lookup array to prevent doing the same work over and over</div>
</section>
</li>
</ul>
</section>
</li>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;()">
<h3>BloomFilterUtil</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/util/BloomFilterUtil.html#line-59">BloomFilterUtil</a></span>()</div>
<div class="block">Private constructor to keep this class from being instantiated.</div>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="computeBitSize(long,double)">
<h3>computeBitSize</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">long</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/util/BloomFilterUtil.html#line-67">computeBitSize</a></span><wbr><span class="parameters">(long&nbsp;maxKeys,
 double&nbsp;errorRate)</span></div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the number of bits for a Bloom filter than can hold the given number of keys and
         provide the given error rate, assuming that the optimal number of hash functions is
         used and it does not have to be an integer.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setRandomGeneratorForTest(java.util.Random)">
<h3>setRandomGeneratorForTest</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/util/BloomFilterUtil.html#line-79">setRandomGeneratorForTest</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/util/Random.html" title="class or interface in java.util" class="external-link">Random</a>&nbsp;random)</span></div>
<div class="block">Sets a random generator to be used for look-ups instead of computing hashes. Can be used to
 simulate uniformity of accesses better in a test environment. Should not be set in a real
 environment where correctness matters!
 <p>
 This gets used in <a href="#contains(org.apache.hadoop.hbase.nio.ByteBuff,int,int,org.apache.hadoop.hbase.util.Hash,int,org.apache.hadoop.hbase.util.HashKey)"><code>contains(ByteBuff, int, int, Hash, int, HashKey)</code></a></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>random</code> - The random number source to use, or null to compute actual hashes</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="idealMaxKeys(long,double)">
<h3>idealMaxKeys</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">long</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/util/BloomFilterUtil.html#line-92">idealMaxKeys</a></span><wbr><span class="parameters">(long&nbsp;bitSize,
 double&nbsp;errorRate)</span></div>
<div class="block">The maximum number of keys we can put into a Bloom filter of a certain size to maintain the
 given error rate, assuming the number of hash functions is chosen optimally and does not even
 have to be an integer (hence the "ideal" in the function name).</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>maximum number of keys that can be inserted into the Bloom filter</dd>
<dt>See Also:</dt>
<dd>
<ul class="see-list-long">
<li><a href="#computeMaxKeys(long,double,int)"><code>for a more precise estimate</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="computeMaxKeys(long,double,int)">
<h3>computeMaxKeys</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">long</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/util/BloomFilterUtil.html#line-104">computeMaxKeys</a></span><wbr><span class="parameters">(long&nbsp;bitSize,
 double&nbsp;errorRate,
 int&nbsp;hashCount)</span></div>
<div class="block">The maximum number of keys we can put into a Bloom filter of a certain size to get the given
 error rate, with the given number of hash functions.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the maximum number of keys that can be inserted in a Bloom filter to maintain the
         target error rate, if the number of hash functions is provided.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="actualErrorRate(long,long,int)">
<h3>actualErrorRate</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/util/BloomFilterUtil.html#line-116">actualErrorRate</a></span><wbr><span class="parameters">(long&nbsp;maxKeys,
 long&nbsp;bitSize,
 int&nbsp;functionCount)</span></div>
<div class="block">Computes the actual error rate for the given number of elements, number of bits, and number of
 hash functions. Taken directly from the
 <a href="http://en.wikipedia.org/wiki/Bloom_filter#Probability_of_false_positives"> Wikipedia
 Bloom filter article</a>.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the actual error rate</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="computeFoldableByteSize(long,int)">
<h3>computeFoldableByteSize</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/util/BloomFilterUtil.html#line-125">computeFoldableByteSize</a></span><wbr><span class="parameters">(long&nbsp;bitSize,
 int&nbsp;foldFactor)</span></div>
<div class="block">Increases the given byte size of a Bloom filter until it can be folded by the given factor.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>Foldable byte size</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="optimalFunctionCount(int,long)">
<h3>optimalFunctionCount</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/util/BloomFilterUtil.html#line-140">optimalFunctionCount</a></span><wbr><span class="parameters">(int&nbsp;maxKeys,
 long&nbsp;bitSize)</span></div>
</section>
</li>
<li>
<section class="detail" id="createBySize(int,double,int,int,org.apache.hadoop.hbase.regionserver.BloomType)">
<h3>createBySize</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="BloomFilterChunk.html" title="class in org.apache.hadoop.hbase.util">BloomFilterChunk</a></span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/util/BloomFilterUtil.html#line-157">createBySize</a></span><wbr><span class="parameters">(int&nbsp;byteSizeHint,
 double&nbsp;errorRate,
 int&nbsp;hashType,
 int&nbsp;foldFactor,
 <a href="../regionserver/BloomType.html" title="enum in org.apache.hadoop.hbase.regionserver">BloomType</a>&nbsp;bloomType)</span></div>
<div class="block">Creates a Bloom filter chunk of the given size.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>byteSizeHint</code> - the desired number of bytes for the Bloom filter bit array. Will be
                     increased so that folding is possible.</dd>
<dd><code>errorRate</code> - target false positive rate of the Bloom filter</dd>
<dd><code>hashType</code> - Bloom filter hash function type</dd>
<dt>Returns:</dt>
<dd>the new Bloom filter of the desired size</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="contains(byte[],int,int,org.apache.hadoop.hbase.nio.ByteBuff,int,int,org.apache.hadoop.hbase.util.Hash,int)">
<h3>contains</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/util/BloomFilterUtil.html#line-174">contains</a></span><wbr><span class="parameters">(byte[]&nbsp;buf,
 int&nbsp;offset,
 int&nbsp;length,
 <a href="../nio/ByteBuff.html" title="class in org.apache.hadoop.hbase.nio">ByteBuff</a>&nbsp;bloomBuf,
 int&nbsp;bloomOffset,
 int&nbsp;bloomSize,
 <a href="Hash.html" title="class in org.apache.hadoop.hbase.util">Hash</a>&nbsp;hash,
 int&nbsp;hashCount)</span></div>
</section>
</li>
<li>
<section class="detail" id="contains(org.apache.hadoop.hbase.nio.ByteBuff,int,int,org.apache.hadoop.hbase.util.Hash,int,org.apache.hadoop.hbase.util.HashKey)">
<h3>contains</h3>
<div class="member-signature"><span class="modifiers">private static</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/util/BloomFilterUtil.html#line-180">contains</a></span><wbr><span class="parameters">(<a href="../nio/ByteBuff.html" title="class in org.apache.hadoop.hbase.nio">ByteBuff</a>&nbsp;bloomBuf,
 int&nbsp;bloomOffset,
 int&nbsp;bloomSize,
 <a href="Hash.html" title="class in org.apache.hadoop.hbase.util">Hash</a>&nbsp;hash,
 int&nbsp;hashCount,
 <a href="HashKey.html" title="class in org.apache.hadoop.hbase.util">HashKey</a>&lt;T&gt;&nbsp;hashKey)</span></div>
</section>
</li>
<li>
<section class="detail" id="contains(org.apache.hadoop.hbase.Cell,org.apache.hadoop.hbase.nio.ByteBuff,int,int,org.apache.hadoop.hbase.util.Hash,int,org.apache.hadoop.hbase.regionserver.BloomType)">
<h3>contains</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/util/BloomFilterUtil.html#line-208">contains</a></span><wbr><span class="parameters">(<a href="../Cell.html" title="interface in org.apache.hadoop.hbase">Cell</a>&nbsp;cell,
 <a href="../nio/ByteBuff.html" title="class in org.apache.hadoop.hbase.nio">ByteBuff</a>&nbsp;bloomBuf,
 int&nbsp;bloomOffset,
 int&nbsp;bloomSize,
 <a href="Hash.html" title="class in org.apache.hadoop.hbase.util">Hash</a>&nbsp;hash,
 int&nbsp;hashCount,
 <a href="../regionserver/BloomType.html" title="enum in org.apache.hadoop.hbase.regionserver">BloomType</a>&nbsp;type)</span></div>
</section>
</li>
<li>
<section class="detail" id="checkBit(int,org.apache.hadoop.hbase.nio.ByteBuff,int)">
<h3>checkBit</h3>
<div class="member-signature"><span class="modifiers">static</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/util/BloomFilterUtil.html#line-220">checkBit</a></span><wbr><span class="parameters">(int&nbsp;pos,
 <a href="../nio/ByteBuff.html" title="class in org.apache.hadoop.hbase.nio">ByteBuff</a>&nbsp;bloomBuf,
 int&nbsp;bloomOffset)</span></div>
<div class="block">Check if bit at specified index is 1.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>pos</code> - index of bit</dd>
<dt>Returns:</dt>
<dd>true if bit at specified index is 1, false if 0.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="formatStats(org.apache.hadoop.hbase.util.BloomFilterBase)">
<h3>formatStats</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/util/BloomFilterUtil.html#line-234">formatStats</a></span><wbr><span class="parameters">(<a href="BloomFilterBase.html" title="interface in org.apache.hadoop.hbase.util">BloomFilterBase</a>&nbsp;bloomFilter)</span></div>
<div class="block">A human-readable string with statistics for the given Bloom filter.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>bloomFilter</code> - the Bloom filter to output statistics for;</dd>
<dt>Returns:</dt>
<dd>a string consisting of "&lt;key&gt;: &lt;value&gt;" parts separated by
         <a href="#STATS_RECORD_SEP"><code>STATS_RECORD_SEP</code></a>.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="toString(org.apache.hadoop.hbase.util.BloomFilterChunk)">
<h3>toString</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/util/BloomFilterUtil.html#line-249">toString</a></span><wbr><span class="parameters">(<a href="BloomFilterChunk.html" title="class in org.apache.hadoop.hbase.util">BloomFilterChunk</a>&nbsp;bloomFilter)</span></div>
</section>
</li>
<li>
<section class="detail" id="getBloomFilterParam(org.apache.hadoop.hbase.regionserver.BloomType,org.apache.hadoop.conf.Configuration)">
<h3>getBloomFilterParam</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/util/BloomFilterUtil.html#line-254">getBloomFilterParam</a></span><wbr><span class="parameters">(<a href="../regionserver/BloomType.html" title="enum in org.apache.hadoop.hbase.regionserver">BloomType</a>&nbsp;bloomFilterType,
 org.apache.hadoop.conf.Configuration&nbsp;conf)</span>
                                  throws <span class="exceptions"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></span></div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code></dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Copyright &#169; 2007&#x2013;2020 <a href="https://www.apache.org/">The Apache Software Foundation</a>. All rights reserved.</small></p>
</footer>
</div>
</div>
</body>
</html>
