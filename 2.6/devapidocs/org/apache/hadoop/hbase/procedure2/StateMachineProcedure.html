<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (17) -->
<title>StateMachineProcedure (Apache HBase 2.6.0 API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="description" content="declaration: package: org.apache.hadoop.hbase.procedure2, class: StateMachineProcedure">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/StateMachineProcedure.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html#class">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li><a href="#nested-class-summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field-summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li><a href="#field-detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" value="search" disabled="disabled">
<input type="reset" id="reset-button" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">org.apache.hadoop.hbase.procedure2</a></div>
<h1 title="Class StateMachineProcedure" class="title">Class StateMachineProcedure&lt;TEnvironment,<wbr>TState&gt;</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance"><a href="Procedure.html" title="class in org.apache.hadoop.hbase.procedure2">org.apache.hadoop.hbase.procedure2.Procedure</a>&lt;TEnvironment&gt;
<div class="inheritance">org.apache.hadoop.hbase.procedure2.StateMachineProcedure&lt;TEnvironment,<wbr>TState&gt;</div>
</div>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>All Implemented Interfaces:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Comparable.html" title="class or interface in java.lang" class="external-link">Comparable</a>&lt;<a href="Procedure.html" title="class in org.apache.hadoop.hbase.procedure2">Procedure</a>&lt;TEnvironment&gt;&gt;</code></dd>
</dl>
<dl class="notes">
<dt>Direct Known Subclasses:</dt>
<dd><code><a href="../master/replication/AbstractPeerProcedure.html" title="class in org.apache.hadoop.hbase.master.replication">AbstractPeerProcedure</a></code>, <code><a href="../master/procedure/AbstractStateMachineNamespaceProcedure.html" title="class in org.apache.hadoop.hbase.master.procedure">AbstractStateMachineNamespaceProcedure</a></code>, <code><a href="../master/procedure/AbstractStateMachineTableProcedure.html" title="class in org.apache.hadoop.hbase.master.procedure">AbstractStateMachineTableProcedure</a></code>, <code><a href="../master/procedure/RecoverMetaProcedure.html" title="class in org.apache.hadoop.hbase.master.procedure">RecoverMetaProcedure</a></code>, <code><a href="../master/procedure/ServerCrashProcedure.html" title="class in org.apache.hadoop.hbase.master.procedure">ServerCrashProcedure</a></code>, <code><a href="../master/procedure/SplitWALProcedure.html" title="class in org.apache.hadoop.hbase.master.procedure">SplitWALProcedure</a></code>, <code><a href="../master/procedure/SwitchRpcThrottleProcedure.html" title="class in org.apache.hadoop.hbase.master.procedure">SwitchRpcThrottleProcedure</a></code></dd>
</dl>
<hr>
<div class="type-signature"><span class="annotations">@Private
@Evolving
</span><span class="modifiers">public abstract class </span><span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-42">StateMachineProcedure</a>&lt;TEnvironment,<wbr>TState&gt;</span>
<span class="extends-implements">extends <a href="Procedure.html" title="class in org.apache.hadoop.hbase.procedure2">Procedure</a>&lt;TEnvironment&gt;</span></div>
<div class="block">Procedure described by a series of steps.
 <p>
 The procedure implementor must have an enum of 'states', describing the various step of the
 procedure. Once the procedure is running, the procedure-framework will call executeFromState()
 using the 'state' provided by the user. The first call to executeFromState() will be performed
 with 'state = null'. The implementor can jump between states using
 setNextState(MyStateEnum.ordinal()). The rollback will call rollbackState() for each state that
 was executed, in reverse order.</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<li>
<section class="nested-class-summary" id="nested-class-summary">
<h2>Nested Class Summary</h2>
<div class="caption"><span>Nested Classes</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Class</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>static enum&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="StateMachineProcedure.Flow.html" class="type-name-link" title="enum in org.apache.hadoop.hbase.procedure2">StateMachineProcedure.Flow</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
</div>
<div class="inherited-list">
<h2 id="nested-classes-inherited-from-class-org.apache.hadoop.hbase.procedure2.Procedure">Nested classes/interfaces inherited from class&nbsp;org.apache.hadoop.hbase.procedure2.<a href="Procedure.html" title="class in org.apache.hadoop.hbase.procedure2">Procedure</a></h2>
<code><a href="Procedure.LockState.html" title="enum in org.apache.hadoop.hbase.procedure2">Procedure.LockState</a></code></div>
</section>
</li>
<!-- =========== FIELD SUMMARY =========== -->
<li>
<section class="field-summary" id="field-summary">
<h2>Field Summary</h2>
<div class="caption"><span>Fields</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Field</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>private final <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/AtomicBoolean.html" title="class or interface in java.util.concurrent.atomic" class="external-link">AtomicBoolean</a></code></div>
<div class="col-second even-row-color"><code><a href="#aborted" class="member-name-link">aborted</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>private int</code></div>
<div class="col-second odd-row-color"><code><a href="#cycles" class="member-name-link">cycles</a></code></div>
<div class="col-last odd-row-color">
<div class="block">Cycles on same state.</div>
</div>
<div class="col-first even-row-color"><code>private static final int</code></div>
<div class="col-second even-row-color"><code><a href="#EOF_STATE" class="member-name-link">EOF_STATE</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>private static final org.slf4j.Logger</code></div>
<div class="col-second odd-row-color"><code><a href="#LOG" class="member-name-link">LOG</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>private int</code></div>
<div class="col-second even-row-color"><code><a href="#previousState" class="member-name-link">previousState</a></code></div>
<div class="col-last even-row-color">
<div class="block">Ordinal of the previous state.</div>
</div>
<div class="col-first odd-row-color"><code>protected int</code></div>
<div class="col-second odd-row-color"><code><a href="#stateCount" class="member-name-link">stateCount</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>private <a href="StateMachineProcedure.Flow.html" title="enum in org.apache.hadoop.hbase.procedure2">StateMachineProcedure.Flow</a></code></div>
<div class="col-second even-row-color"><code><a href="#stateFlow" class="member-name-link">stateFlow</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>private int[]</code></div>
<div class="col-second odd-row-color"><code><a href="#states" class="member-name-link">states</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>private <a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="Procedure.html" title="class in org.apache.hadoop.hbase.procedure2">Procedure</a>&lt;<a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TEnvironment</a>&gt;&gt;</code></div>
<div class="col-second even-row-color"><code><a href="#subProcList" class="member-name-link">subProcList</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
</div>
<div class="inherited-list">
<h3 id="fields-inherited-from-class-org.apache.hadoop.hbase.procedure2.Procedure">Fields inherited from class&nbsp;org.apache.hadoop.hbase.procedure2.<a href="Procedure.html" title="class in org.apache.hadoop.hbase.procedure2">Procedure</a></h3>
<code><a href="Procedure.html#NO_PROC_ID">NO_PROC_ID</a>, <a href="Procedure.html#NO_TIMEOUT">NO_TIMEOUT</a></code></div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E()" class="member-name-link">StateMachineProcedure</a>()</code></div>
<div class="col-last even-row-color">&nbsp;</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab3" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab3', 3)" class="table-tab">Abstract Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel" aria-labelledby="method-summary-table-tab0">
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#abort(TEnvironment)" class="member-name-link">abort</a><wbr>(<a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TEnvironment</a>&nbsp;env)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">The abort() call is asynchronous and each procedure must decide how to deal with it, if they
 want to be abortable.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected &lt;T extends <a href="Procedure.html" title="class in org.apache.hadoop.hbase.procedure2">Procedure</a>&lt;<a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TEnvironment</a>&gt;&gt;<br>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#addChildProcedure(T...)" class="member-name-link">addChildProcedure</a><wbr>(T...&nbsp;subProcedure)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Add a child procedure to execute</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#deserializeStateData(org.apache.hadoop.hbase.procedure2.ProcedureStateSerializer)" class="member-name-link">deserializeStateData</a><wbr>(<a href="ProcedureStateSerializer.html" title="interface in org.apache.hadoop.hbase.procedure2">ProcedureStateSerializer</a>&nbsp;serializer)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Called on store load to allow the user to decode the previously serialized state.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected <a href="Procedure.html" title="class in org.apache.hadoop.hbase.procedure2">Procedure</a>[]</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#execute(TEnvironment)" class="member-name-link">execute</a><wbr>(<a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TEnvironment</a>&nbsp;env)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">The main code of the procedure.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>protected abstract <a href="StateMachineProcedure.Flow.html" title="enum in org.apache.hadoop.hbase.procedure2">StateMachineProcedure.Flow</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#executeFromState(TEnvironment,TState)" class="member-name-link">executeFromState</a><wbr>(<a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TEnvironment</a>&nbsp;env,
 <a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TState</a>&nbsp;state)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">called to perform a single step of the specified 'state' of the procedure</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected final void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#failIfAborted()" class="member-name-link">failIfAborted</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">If procedure has more states then abort it otherwise procedure is finished and abort can be
 ignored.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected <a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TState</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getCurrentState()" class="member-name-link">getCurrentState</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>int</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getCurrentStateId()" class="member-name-link">getCurrentStateId</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">This method is used from test code as it cannot be assumed that state transition will happen
 sequentially.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected final int</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getCycles()" class="member-name-link">getCycles</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>protected abstract <a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TState</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#getInitialState()" class="member-name-link">getInitialState</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Return the initial state object that will be used for the first call to executeFromState().</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>protected abstract <a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TState</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#getState(int)" class="member-name-link">getState</a><wbr>(int&nbsp;stateId)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Convert an ordinal (or state id) to an Enum (or more descriptive) state object.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>protected abstract int</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#getStateId(TState)" class="member-name-link">getStateId</a><wbr>(<a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TState</a>&nbsp;state)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Convert the Enum (or more descriptive) state object to an ordinal (or state id).</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#hasMoreState()" class="member-name-link">hasMoreState</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#isEofState()" class="member-name-link">isEofState</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected final boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#isRollbackSupported()" class="member-name-link">isRollbackSupported</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Return whether the procedure supports rollback.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#isRollbackSupported(TState)" class="member-name-link">isRollbackSupported</a><wbr>(<a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TState</a>&nbsp;state)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Used by the default implementation of abort() to know if the current state can be aborted and
 rollback can be triggered.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#isYieldAfterExecutionStep(TEnvironment)" class="member-name-link">isYieldAfterExecutionStep</a><wbr>(<a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TEnvironment</a>&nbsp;env)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">By default, the procedure framework/executor will try to run procedures start to finish.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#isYieldBeforeExecuteFromState(TEnvironment,TState)" class="member-name-link">isYieldBeforeExecuteFromState</a><wbr>(<a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TEnvironment</a>&nbsp;env,
 <a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TState</a>&nbsp;state)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">By default, the executor will try ro run all the steps of the procedure start to finish.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#rollback(TEnvironment)" class="member-name-link">rollback</a><wbr>(<a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TEnvironment</a>&nbsp;env)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">The code to undo what was done by the execute() code.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>protected abstract void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#rollbackState(TEnvironment,TState)" class="member-name-link">rollbackState</a><wbr>(<a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TEnvironment</a>&nbsp;env,
 <a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TState</a>&nbsp;state)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">called to perform the rollback of the specified state</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#serializeStateData(org.apache.hadoop.hbase.procedure2.ProcedureStateSerializer)" class="member-name-link">serializeStateData</a><wbr>(<a href="ProcedureStateSerializer.html" title="interface in org.apache.hadoop.hbase.procedure2">ProcedureStateSerializer</a>&nbsp;serializer)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">The user-level code of the procedure may have some state to persist (e.g.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#setNextState(int)" class="member-name-link">setNextState</a><wbr>(int&nbsp;stateId)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Set the next state for the procedure.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#setNextState(TState)" class="member-name-link">setNextState</a><wbr>(<a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TState</a>&nbsp;state)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Set the next state for the procedure.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#toStringState(java.lang.StringBuilder)" class="member-name-link">toStringState</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/StringBuilder.html" title="class or interface in java.lang" class="external-link">StringBuilder</a>&nbsp;builder)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Called from <a href="Procedure.html#toString()"><code>Procedure.toString()</code></a> when interpolating <a href="Procedure.html" title="class in org.apache.hadoop.hbase.procedure2"><code>Procedure</code></a> State.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-org.apache.hadoop.hbase.procedure2.Procedure">Methods inherited from class&nbsp;org.apache.hadoop.hbase.procedure2.<a href="Procedure.html" title="class in org.apache.hadoop.hbase.procedure2">Procedure</a></h3>
<code><a href="Procedure.html#acquireLock(TEnvironment)">acquireLock</a>, <a href="Procedure.html#addStackIndex(int)">addStackIndex</a>, <a href="Procedure.html#afterReplay(TEnvironment)">afterReplay</a>, <a href="Procedure.html#beforeReplay(TEnvironment)">beforeReplay</a>, <a href="Procedure.html#bypass(TEnvironment)">bypass</a>, <a href="Procedure.html#compareTo(org.apache.hadoop.hbase.procedure2.Procedure)">compareTo</a>, <a href="Procedure.html#completionCleanup(TEnvironment)">completionCleanup</a>, <a href="Procedure.html#doAcquireLock(TEnvironment,org.apache.hadoop.hbase.procedure2.store.ProcedureStore)">doAcquireLock</a>, <a href="Procedure.html#doExecute(TEnvironment)">doExecute</a>, <a href="Procedure.html#doReleaseLock(TEnvironment,org.apache.hadoop.hbase.procedure2.store.ProcedureStore)">doReleaseLock</a>, <a href="Procedure.html#doRollback(TEnvironment)">doRollback</a>, <a href="Procedure.html#elapsedTime()">elapsedTime</a>, <a href="Procedure.html#getChildrenLatch()">getChildrenLatch</a>, <a href="Procedure.html#getException()">getException</a>, <a href="Procedure.html#getLastUpdate()">getLastUpdate</a>, <a href="Procedure.html#getNonceKey()">getNonceKey</a>, <a href="Procedure.html#getOwner()">getOwner</a>, <a href="Procedure.html#getParentProcId()">getParentProcId</a>, <a href="Procedure.html#getProcedureMetrics(TEnvironment)">getProcedureMetrics</a>, <a href="Procedure.html#getProcId()">getProcId</a>, <a href="Procedure.html#getProcIdHashCode(long)">getProcIdHashCode</a>, <a href="Procedure.html#getProcName()">getProcName</a>, <a href="Procedure.html#getResult()">getResult</a>, <a href="Procedure.html#getRootProcedureId(java.util.Map,org.apache.hadoop.hbase.procedure2.Procedure)">getRootProcedureId</a>, <a href="Procedure.html#getRootProcId()">getRootProcId</a>, <a href="Procedure.html#getStackIndexes()">getStackIndexes</a>, <a href="Procedure.html#getState()">getState</a>, <a href="Procedure.html#getSubmittedTime()">getSubmittedTime</a>, <a href="Procedure.html#getTimeout()">getTimeout</a>, <a href="Procedure.html#getTimeoutTimestamp()">getTimeoutTimestamp</a>, <a href="Procedure.html#hasChildren()">hasChildren</a>, <a href="Procedure.html#hasException()">hasException</a>, <a href="Procedure.html#hasLock()">hasLock</a>, <a href="Procedure.html#hasOwner()">hasOwner</a>, <a href="Procedure.html#hasParent()">hasParent</a>, <a href="Procedure.html#hasTimeout()">hasTimeout</a>, <a href="Procedure.html#haveSameParent(org.apache.hadoop.hbase.procedure2.Procedure,org.apache.hadoop.hbase.procedure2.Procedure)">haveSameParent</a>, <a href="Procedure.html#holdLock(TEnvironment)">holdLock</a>, <a href="Procedure.html#incChildrenLatch()">incChildrenLatch</a>, <a href="Procedure.html#isBypass()">isBypass</a>, <a href="Procedure.html#isFailed()">isFailed</a>, <a href="Procedure.html#isFinished()">isFinished</a>, <a href="Procedure.html#isInitializing()">isInitializing</a>, <a href="Procedure.html#isLockedWhenLoading()">isLockedWhenLoading</a>, <a href="Procedure.html#isRunnable()">isRunnable</a>, <a href="Procedure.html#isSuccess()">isSuccess</a>, <a href="Procedure.html#isWaiting()">isWaiting</a>, <a href="Procedure.html#lockedWhenLoading()">lockedWhenLoading</a>, <a href="Procedure.html#needPersistence()">needPersistence</a>, <a href="Procedure.html#releaseLock(TEnvironment)">releaseLock</a>, <a href="Procedure.html#removeStackIndex()">removeStackIndex</a>, <a href="Procedure.html#resetPersistence()">resetPersistence</a>, <a href="Procedure.html#restoreLock(TEnvironment)">restoreLock</a>, <a href="Procedure.html#setAbortFailure(java.lang.String,java.lang.String)">setAbortFailure</a>, <a href="Procedure.html#setChildrenLatch(int)">setChildrenLatch</a>, <a href="Procedure.html#setExecuted()">setExecuted</a>, <a href="Procedure.html#setFailure(java.lang.String,java.lang.Throwable)">setFailure</a>, <a href="Procedure.html#setFailure(org.apache.hadoop.hbase.procedure2.RemoteProcedureException)">setFailure</a>, <a href="Procedure.html#setLastUpdate(long)">setLastUpdate</a>, <a href="Procedure.html#setNonceKey(org.apache.hadoop.hbase.util.NonceKey)">setNonceKey</a>, <a href="Procedure.html#setOwner(java.lang.String)">setOwner</a>, <a href="Procedure.html#setOwner(org.apache.hadoop.hbase.security.User)">setOwner</a>, <a href="Procedure.html#setParentProcId(long)">setParentProcId</a>, <a href="Procedure.html#setProcId(long)">setProcId</a>, <a href="Procedure.html#setResult(byte%5B%5D)">setResult</a>, <a href="Procedure.html#setRootProcId(long)">setRootProcId</a>, <a href="Procedure.html#setStackIndexes(java.util.List)">setStackIndexes</a>, <a href="Procedure.html#setState(org.apache.hadoop.hbase.shaded.protobuf.generated.ProcedureProtos.ProcedureState)">setState</a>, <a href="Procedure.html#setSubmittedTime(long)">setSubmittedTime</a>, <a href="Procedure.html#setTimeout(int)">setTimeout</a>, <a href="Procedure.html#setTimeoutFailure(TEnvironment)">setTimeoutFailure</a>, <a href="Procedure.html#shouldWaitClientAck(TEnvironment)">shouldWaitClientAck</a>, <a href="Procedure.html#skipPersistence()">skipPersistence</a>, <a href="Procedure.html#suspend(int,boolean)">suspend</a>, <a href="Procedure.html#toString()">toString</a>, <a href="Procedure.html#toStringClass()">toStringClass</a>, <a href="Procedure.html#toStringClassDetails(java.lang.StringBuilder)">toStringClassDetails</a>, <a href="Procedure.html#toStringDetails()">toStringDetails</a>, <a href="Procedure.html#toStringSimpleSB()">toStringSimpleSB</a>, <a href="Procedure.html#tryRunnable()">tryRunnable</a>, <a href="Procedure.html#updateMetricsOnFinish(TEnvironment,long,boolean)">updateMetricsOnFinish</a>, <a href="Procedure.html#updateMetricsOnSubmit(TEnvironment)">updateMetricsOnSubmit</a>, <a href="Procedure.html#updateTimestamp()">updateTimestamp</a>, <a href="Procedure.html#waitInitialized(TEnvironment)">waitInitialized</a>, <a href="Procedure.html#wasExecuted()">wasExecuted</a></code></div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#clone--" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#equals-java.lang.Object-" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#finalize--" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#getClass--" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#hashCode--" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#notify--" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#notifyAll--" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait--" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait-long-" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait-long-int-" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ FIELD DETAIL =========== -->
<li>
<section class="field-details" id="field-detail">
<h2>Field Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="LOG">
<h3>LOG</h3>
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type">org.slf4j.Logger</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-45">LOG</a></span></div>
</section>
</li>
<li>
<section class="detail" id="EOF_STATE">
<h3>EOF_STATE</h3>
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-47">EOF_STATE</a></span></div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../constant-values.html#org.apache.hadoop.hbase.procedure2.StateMachineProcedure.EOF_STATE">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="aborted">
<h3>aborted</h3>
<div class="member-signature"><span class="modifiers">private final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/AtomicBoolean.html" title="class or interface in java.util.concurrent.atomic" class="external-link">AtomicBoolean</a></span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-49">aborted</a></span></div>
</section>
</li>
<li>
<section class="detail" id="stateFlow">
<h3>stateFlow</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type"><a href="StateMachineProcedure.Flow.html" title="enum in org.apache.hadoop.hbase.procedure2">StateMachineProcedure.Flow</a></span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-51">stateFlow</a></span></div>
</section>
</li>
<li>
<section class="detail" id="stateCount">
<h3>stateCount</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-52">stateCount</a></span></div>
</section>
</li>
<li>
<section class="detail" id="states">
<h3>states</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">int[]</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-53">states</a></span></div>
</section>
</li>
<li>
<section class="detail" id="subProcList">
<h3>subProcList</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="Procedure.html" title="class in org.apache.hadoop.hbase.procedure2">Procedure</a>&lt;<a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TEnvironment</a>&gt;&gt;</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-55">subProcList</a></span></div>
</section>
</li>
<li>
<section class="detail" id="cycles">
<h3>cycles</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-64">cycles</a></span></div>
<div class="block">Cycles on same state. Good for figuring if we are stuck.</div>
</section>
</li>
<li>
<section class="detail" id="previousState">
<h3>previousState</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-69">previousState</a></span></div>
<div class="block">Ordinal of the previous state. So we can tell if we are progressing or not.</div>
</section>
</li>
</ul>
</section>
</li>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;()">
<h3>StateMachineProcedure</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-44">StateMachineProcedure</a></span>()</div>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="getCycles()">
<h3>getCycles</h3>
<div class="member-signature"><span class="modifiers">protected final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-57">getCycles</a></span>()</div>
</section>
</li>
<li>
<section class="detail" id="executeFromState(TEnvironment,TState)">
<h3 id="executeFromState(java.lang.Object,java.lang.Object)">executeFromState</h3>
<div class="member-signature"><span class="modifiers">protected abstract</span>&nbsp;<span class="return-type"><a href="StateMachineProcedure.Flow.html" title="enum in org.apache.hadoop.hbase.procedure2">StateMachineProcedure.Flow</a></span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-82">executeFromState</a></span><wbr><span class="parameters">(<a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TEnvironment</a>&nbsp;env,
 <a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TState</a>&nbsp;state)</span>
                                                        throws <span class="exceptions"><a href="ProcedureSuspendedException.html" title="class in org.apache.hadoop.hbase.procedure2">ProcedureSuspendedException</a>,
<a href="ProcedureYieldException.html" title="class in org.apache.hadoop.hbase.procedure2">ProcedureYieldException</a>,
<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/InterruptedException.html" title="class or interface in java.lang" class="external-link">InterruptedException</a></span></div>
<div class="block">called to perform a single step of the specified 'state' of the procedure</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>state</code> - state to execute</dd>
<dt>Returns:</dt>
<dd>Flow.NO_MORE_STATE if the procedure is completed, Flow.HAS_MORE_STATE if there is
         another step.</dd>
<dt>Throws:</dt>
<dd><code><a href="ProcedureSuspendedException.html" title="class in org.apache.hadoop.hbase.procedure2">ProcedureSuspendedException</a></code></dd>
<dd><code><a href="ProcedureYieldException.html" title="class in org.apache.hadoop.hbase.procedure2">ProcedureYieldException</a></code></dd>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/InterruptedException.html" title="class or interface in java.lang" class="external-link">InterruptedException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="rollbackState(TEnvironment,TState)">
<h3 id="rollbackState(java.lang.Object,java.lang.Object)">rollbackState</h3>
<div class="member-signature"><span class="modifiers">protected abstract</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-90">rollbackState</a></span><wbr><span class="parameters">(<a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TEnvironment</a>&nbsp;env,
 <a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TState</a>&nbsp;state)</span>
                               throws <span class="exceptions"><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a>,
<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/InterruptedException.html" title="class or interface in java.lang" class="external-link">InterruptedException</a></span></div>
<div class="block">called to perform the rollback of the specified state</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>state</code> - state to rollback</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - temporary failure, the rollback will retry later</dd>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/InterruptedException.html" title="class or interface in java.lang" class="external-link">InterruptedException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getState(int)">
<h3>getState</h3>
<div class="member-signature"><span class="modifiers">protected abstract</span>&nbsp;<span class="return-type"><a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TState</a></span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-98">getState</a></span><wbr><span class="parameters">(int&nbsp;stateId)</span></div>
<div class="block">Convert an ordinal (or state id) to an Enum (or more descriptive) state object.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>stateId</code> - the ordinal() of the state enum (or state id)</dd>
<dt>Returns:</dt>
<dd>the state enum object</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getStateId(TState)">
<h3 id="getStateId(java.lang.Object)">getStateId</h3>
<div class="member-signature"><span class="modifiers">protected abstract</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-105">getStateId</a></span><wbr><span class="parameters">(<a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TState</a>&nbsp;state)</span></div>
<div class="block">Convert the Enum (or more descriptive) state object to an ordinal (or state id).</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>state</code> - the state enum object</dd>
<dt>Returns:</dt>
<dd>stateId the ordinal() of the state enum (or state id)</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getInitialState()">
<h3>getInitialState</h3>
<div class="member-signature"><span class="modifiers">protected abstract</span>&nbsp;<span class="return-type"><a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TState</a></span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-111">getInitialState</a></span>()</div>
<div class="block">Return the initial state object that will be used for the first call to executeFromState().</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the initial state enum object</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setNextState(TState)">
<h3 id="setNextState(java.lang.Object)">setNextState</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-117">setNextState</a></span><wbr><span class="parameters">(<a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TState</a>&nbsp;state)</span></div>
<div class="block">Set the next state for the procedure.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>state</code> - the state enum object</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="isYieldBeforeExecuteFromState(TEnvironment,TState)">
<h3 id="isYieldBeforeExecuteFromState(java.lang.Object,java.lang.Object)">isYieldBeforeExecuteFromState</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-130">isYieldBeforeExecuteFromState</a></span><wbr><span class="parameters">(<a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TEnvironment</a>&nbsp;env,
 <a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TState</a>&nbsp;state)</span></div>
<div class="block">By default, the executor will try ro run all the steps of the procedure start to finish. Return
 true to make the executor yield between execution steps to give other procedures time to run
 their steps.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>state</code> - the state we are going to execute next.</dd>
<dt>Returns:</dt>
<dd>Return true if the executor should yield before the execution of the specified step.
         Defaults to return false.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="addChildProcedure(T...)">
<h3 id="addChildProcedure(org.apache.hadoop.hbase.procedure2.Procedure[])">addChildProcedure</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="type-parameters">&lt;T extends <a href="Procedure.html" title="class in org.apache.hadoop.hbase.procedure2">Procedure</a>&lt;<a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TEnvironment</a>&gt;&gt;</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-138">addChildProcedure</a></span><wbr><span class="parameters">(T...&nbsp;subProcedure)</span></div>
<div class="block">Add a child procedure to execute</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>subProcedure</code> - the child procedure</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="execute(TEnvironment)">
<h3 id="execute(java.lang.Object)">execute</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type"><a href="Procedure.html" title="class in org.apache.hadoop.hbase.procedure2">Procedure</a>[]</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-160">execute</a></span><wbr><span class="parameters">(<a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TEnvironment</a>&nbsp;env)</span>
                       throws <span class="exceptions"><a href="ProcedureSuspendedException.html" title="class in org.apache.hadoop.hbase.procedure2">ProcedureSuspendedException</a>,
<a href="ProcedureYieldException.html" title="class in org.apache.hadoop.hbase.procedure2">ProcedureYieldException</a>,
<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/InterruptedException.html" title="class or interface in java.lang" class="external-link">InterruptedException</a></span></div>
<div class="block"><span class="descfrm-type-label">Description copied from class:&nbsp;<code><a href="Procedure.html#execute(TEnvironment)">Procedure</a></code></span></div>
<div class="block">The main code of the procedure. It must be idempotent since execute() may be called multiple
 times in case of machine failure in the middle of the execution.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="Procedure.html#execute(TEnvironment)">execute</a></code>&nbsp;in class&nbsp;<code><a href="Procedure.html" title="class in org.apache.hadoop.hbase.procedure2">Procedure</a>&lt;<a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TEnvironment</a>&gt;</code></dd>
<dt>Parameters:</dt>
<dd><code>env</code> - the environment passed to the ProcedureExecutor</dd>
<dt>Returns:</dt>
<dd>a set of sub-procedures to run or ourselves if there is more work to do or null if the
         procedure is done.</dd>
<dt>Throws:</dt>
<dd><code><a href="ProcedureSuspendedException.html" title="class in org.apache.hadoop.hbase.procedure2">ProcedureSuspendedException</a></code> - Signal to the executor that Procedure has suspended itself
                                     and has set itself up waiting for an external event to wake
                                     it back up again.</dd>
<dd><code><a href="ProcedureYieldException.html" title="class in org.apache.hadoop.hbase.procedure2">ProcedureYieldException</a></code> - the procedure will be added back to the queue and retried
                                     later.</dd>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/InterruptedException.html" title="class or interface in java.lang" class="external-link">InterruptedException</a></code> - the procedure will be added back to the queue and retried
                                     later.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="rollback(TEnvironment)">
<h3 id="rollback(java.lang.Object)">rollback</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-204">rollback</a></span><wbr><span class="parameters">(<a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TEnvironment</a>&nbsp;env)</span>
                 throws <span class="exceptions"><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a>,
<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/InterruptedException.html" title="class or interface in java.lang" class="external-link">InterruptedException</a></span></div>
<div class="block"><span class="descfrm-type-label">Description copied from class:&nbsp;<code><a href="Procedure.html#rollback(TEnvironment)">Procedure</a></code></span></div>
<div class="block">The code to undo what was done by the execute() code. It is called when the procedure or one of
 the sub-procedures failed or an abort was requested. It should cleanup all the resources
 created by the execute() call. The implementation must be idempotent since rollback() may be
 called multiple time in case of machine failure in the middle of the execution.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="Procedure.html#rollback(TEnvironment)">rollback</a></code>&nbsp;in class&nbsp;<code><a href="Procedure.html" title="class in org.apache.hadoop.hbase.procedure2">Procedure</a>&lt;<a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TEnvironment</a>&gt;</code></dd>
<dt>Parameters:</dt>
<dd><code>env</code> - the environment passed to the ProcedureExecutor</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - temporary failure, the rollback will retry later</dd>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/InterruptedException.html" title="class or interface in java.lang" class="external-link">InterruptedException</a></code> - the procedure will be added back to the queue and retried later</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="isEofState()">
<h3>isEofState</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-219">isEofState</a></span>()</div>
</section>
</li>
<li>
<section class="detail" id="abort(TEnvironment)">
<h3 id="abort(java.lang.Object)">abort</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-223">abort</a></span><wbr><span class="parameters">(<a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TEnvironment</a>&nbsp;env)</span></div>
<div class="block"><span class="descfrm-type-label">Description copied from class:&nbsp;<code><a href="Procedure.html#abort(TEnvironment)">Procedure</a></code></span></div>
<div class="block">The abort() call is asynchronous and each procedure must decide how to deal with it, if they
 want to be abortable. The simplest implementation is to have an AtomicBoolean set in the
 abort() method and then the execute() will check if the abort flag is set or not. abort() may
 be called multiple times from the client, so the implementation must be idempotent.
 <p>
 NOTE: abort() is not like Thread.interrupt(). It is just a notification that allows the
 procedure implementor abort.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="Procedure.html#abort(TEnvironment)">abort</a></code>&nbsp;in class&nbsp;<code><a href="Procedure.html" title="class in org.apache.hadoop.hbase.procedure2">Procedure</a>&lt;<a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TEnvironment</a>&gt;</code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="failIfAborted()">
<h3>failIfAborted</h3>
<div class="member-signature"><span class="modifiers">protected final</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-242">failIfAborted</a></span>()</div>
<div class="block">If procedure has more states then abort it otherwise procedure is finished and abort can be
 ignored.</div>
</section>
</li>
<li>
<section class="detail" id="isRollbackSupported()">
<h3>isRollbackSupported</h3>
<div class="member-signature"><span class="modifiers">protected final</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-252">isRollbackSupported</a></span>()</div>
<div class="block"><span class="descfrm-type-label">Description copied from class:&nbsp;<code><a href="Procedure.html#isRollbackSupported()">Procedure</a></code></span></div>
<div class="block">Return whether the procedure supports rollback. If the procedure does not support rollback, we
 can skip the rollback state management which could increase the performance. See HBASE-28210
 and HBASE-28212.</div>
<dl class="notes">
<dt>Overrides:</dt>
<dd><code><a href="Procedure.html#isRollbackSupported()">isRollbackSupported</a></code>&nbsp;in class&nbsp;<code><a href="Procedure.html" title="class in org.apache.hadoop.hbase.procedure2">Procedure</a>&lt;<a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TEnvironment</a>&gt;</code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="isRollbackSupported(TState)">
<h3 id="isRollbackSupported(java.lang.Object)">isRollbackSupported</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-261">isRollbackSupported</a></span><wbr><span class="parameters">(<a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TState</a>&nbsp;state)</span></div>
<div class="block">Used by the default implementation of abort() to know if the current state can be aborted and
 rollback can be triggered.</div>
</section>
</li>
<li>
<section class="detail" id="isYieldAfterExecutionStep(TEnvironment)">
<h3 id="isYieldAfterExecutionStep(java.lang.Object)">isYieldAfterExecutionStep</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-265">isYieldAfterExecutionStep</a></span><wbr><span class="parameters">(<a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TEnvironment</a>&nbsp;env)</span></div>
<div class="block"><span class="descfrm-type-label">Description copied from class:&nbsp;<code><a href="Procedure.html#isYieldAfterExecutionStep(TEnvironment)">Procedure</a></code></span></div>
<div class="block">By default, the procedure framework/executor will try to run procedures start to finish. Return
 true to make the executor yield between each execution step to give other procedures a chance
 to run.</div>
<dl class="notes">
<dt>Overrides:</dt>
<dd><code><a href="Procedure.html#isYieldAfterExecutionStep(TEnvironment)">isYieldAfterExecutionStep</a></code>&nbsp;in class&nbsp;<code><a href="Procedure.html" title="class in org.apache.hadoop.hbase.procedure2">Procedure</a>&lt;<a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TEnvironment</a>&gt;</code></dd>
<dt>Parameters:</dt>
<dd><code>env</code> - the environment passed to the ProcedureExecutor</dd>
<dt>Returns:</dt>
<dd>Return true if the executor should yield on completion of an execution step. Defaults
         to return false.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="hasMoreState()">
<h3>hasMoreState</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-270">hasMoreState</a></span>()</div>
</section>
</li>
<li>
<section class="detail" id="getCurrentState()">
<h3>getCurrentState</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type"><a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TState</a></span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-274">getCurrentState</a></span>()</div>
</section>
</li>
<li>
<section class="detail" id="getCurrentStateId()">
<h3>getCurrentStateId</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-283">getCurrentStateId</a></span>()</div>
<div class="block">This method is used from test code as it cannot be assumed that state transition will happen
 sequentially. Some procedures may skip steps/ states, some may add intermediate steps in
 future.</div>
</section>
</li>
<li>
<section class="detail" id="setNextState(int)">
<h3>setNextState</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-291">setNextState</a></span><wbr><span class="parameters">(int&nbsp;stateId)</span></div>
<div class="block">Set the next state for the procedure.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>stateId</code> - the ordinal() of the state enum (or state id)</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="toStringState(java.lang.StringBuilder)">
<h3>toStringState</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-303">toStringState</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/StringBuilder.html" title="class or interface in java.lang" class="external-link">StringBuilder</a>&nbsp;builder)</span></div>
<div class="block"><span class="descfrm-type-label">Description copied from class:&nbsp;<code><a href="Procedure.html#toStringState(java.lang.StringBuilder)">Procedure</a></code></span></div>
<div class="block">Called from <a href="Procedure.html#toString()"><code>Procedure.toString()</code></a> when interpolating <a href="Procedure.html" title="class in org.apache.hadoop.hbase.procedure2"><code>Procedure</code></a> State. Allows decorating
 generic Procedure State with Procedure particulars.</div>
<dl class="notes">
<dt>Overrides:</dt>
<dd><code><a href="Procedure.html#toStringState(java.lang.StringBuilder)">toStringState</a></code>&nbsp;in class&nbsp;<code><a href="Procedure.html" title="class in org.apache.hadoop.hbase.procedure2">Procedure</a>&lt;<a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TEnvironment</a>&gt;</code></dd>
<dt>Parameters:</dt>
<dd><code>builder</code> - Append current <code>ProcedureProtos.ProcedureState</code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="serializeStateData(org.apache.hadoop.hbase.procedure2.ProcedureStateSerializer)">
<h3>serializeStateData</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-311">serializeStateData</a></span><wbr><span class="parameters">(<a href="ProcedureStateSerializer.html" title="interface in org.apache.hadoop.hbase.procedure2">ProcedureStateSerializer</a>&nbsp;serializer)</span>
                           throws <span class="exceptions"><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block"><span class="descfrm-type-label">Description copied from class:&nbsp;<code><a href="Procedure.html#serializeStateData(org.apache.hadoop.hbase.procedure2.ProcedureStateSerializer)">Procedure</a></code></span></div>
<div class="block">The user-level code of the procedure may have some state to persist (e.g. input arguments or
 current position in the processing state) to be able to resume on failure.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="Procedure.html#serializeStateData(org.apache.hadoop.hbase.procedure2.ProcedureStateSerializer)">serializeStateData</a></code>&nbsp;in class&nbsp;<code><a href="Procedure.html" title="class in org.apache.hadoop.hbase.procedure2">Procedure</a>&lt;<a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TEnvironment</a>&gt;</code></dd>
<dt>Parameters:</dt>
<dd><code>serializer</code> - stores the serializable state</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="deserializeStateData(org.apache.hadoop.hbase.procedure2.ProcedureStateSerializer)">
<h3>deserializeStateData</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../src-html/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.html#line-320">deserializeStateData</a></span><wbr><span class="parameters">(<a href="ProcedureStateSerializer.html" title="interface in org.apache.hadoop.hbase.procedure2">ProcedureStateSerializer</a>&nbsp;serializer)</span>
                             throws <span class="exceptions"><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block"><span class="descfrm-type-label">Description copied from class:&nbsp;<code><a href="Procedure.html#deserializeStateData(org.apache.hadoop.hbase.procedure2.ProcedureStateSerializer)">Procedure</a></code></span></div>
<div class="block">Called on store load to allow the user to decode the previously serialized state.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="Procedure.html#deserializeStateData(org.apache.hadoop.hbase.procedure2.ProcedureStateSerializer)">deserializeStateData</a></code>&nbsp;in class&nbsp;<code><a href="Procedure.html" title="class in org.apache.hadoop.hbase.procedure2">Procedure</a>&lt;<a href="StateMachineProcedure.html" title="type parameter in StateMachineProcedure">TEnvironment</a>&gt;</code></dd>
<dt>Parameters:</dt>
<dd><code>serializer</code> - contains the serialized state</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Copyright &#169; 2007&#x2013;2020 <a href="https://www.apache.org/">The Apache Software Foundation</a>. All rights reserved.</small></p>
</footer>
</div>
</div>
</body>
</html>
