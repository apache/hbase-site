<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (17) -->
<title>X509TestHelpers (Apache HBase 4.0.0-alpha-1-SNAPSHOT Test API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="description" content="declaration: package: org.apache.hadoop.hbase.io.crypto.tls, class: X509TestHelpers">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/X509TestHelpers.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../../help-doc.html#class">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field-summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li><a href="#field-detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" value="search" disabled="disabled">
<input type="reset" id="reset-button" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">org.apache.hadoop.hbase.io.crypto.tls</a></div>
<h1 title="Class X509TestHelpers" class="title">Class X509TestHelpers</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">org.apache.hadoop.hbase.io.crypto.tls.X509TestHelpers</div>
</div>
<section class="class-description" id="class-description">
<hr>
<div class="type-signature"><span class="annotations">@Private
</span><span class="modifiers">final class </span><span class="element-name"><a href="../../../../../../../src-html/org/apache/hadoop/hbase/io/crypto/tls/X509TestHelpers.html#line-81">X509TestHelpers</a></span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span></div>
<div class="block">This class contains helper methods for creating X509 certificates and key pairs, and for
 serializing them to JKS, PEM or other keystore type files.
 <p/>
 This file has been copied from the Apache ZooKeeper project.</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="https://github.com/apache/zookeeper/blob/c74658d398cdc1d207aa296cb6e20de00faec03e/zookeeper-server/src/test/java/org/apache/zookeeper/common/X509TestHelpers.java">Base
      revision</a></li>
</ul>
</dd>
</dl>
</section>
<section class="summary">
<ul class="summary-list">
<!-- =========== FIELD SUMMARY =========== -->
<li>
<section class="field-summary" id="field-summary">
<h2>Field Summary</h2>
<div class="caption"><span>Fields</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Field</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>private static final <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second even-row-color"><code><a href="#DEFAULT_ELLIPTIC_CURVE_NAME" class="member-name-link">DEFAULT_ELLIPTIC_CURVE_NAME</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>private static final int</code></div>
<div class="col-second odd-row-color"><code><a href="#DEFAULT_RSA_KEY_SIZE_BITS" class="member-name-link">DEFAULT_RSA_KEY_SIZE_BITS</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>private static final <a href="https://docs.oracle.com/javase/8/docs/api/java/math/BigInteger.html" title="class or interface in java.math" class="external-link">BigInteger</a></code></div>
<div class="col-second even-row-color"><code><a href="#DEFAULT_RSA_PUB_EXPONENT" class="member-name-link">DEFAULT_RSA_PUB_EXPONENT</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>private static final <a href="https://docs.oracle.com/javase/8/docs/api/java/security/SecureRandom.html" title="class or interface in java.security" class="external-link">SecureRandom</a></code></div>
<div class="col-second odd-row-color"><code><a href="#PRNG" class="member-name-link">PRNG</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>private static final int</code></div>
<div class="col-second even-row-color"><code><a href="#SERIAL_NUMBER_MAX_BITS" class="member-name-link">SERIAL_NUMBER_MAX_BITS</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
</div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier</div>
<div class="table-header col-second">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>private </code></div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E()" class="member-name-link">X509TestHelpers</a>()</code></div>
<div class="col-last even-row-color">&nbsp;</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab1" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab1', 3)" class="table-tab">Static Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>private static <a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#buildAndSignCertificate(java.security.PrivateKey,org.bouncycastle.cert.X509v3CertificateBuilder)" class="member-name-link">buildAndSignCertificate</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/security/PrivateKey.html" title="class or interface in java.security" class="external-link">PrivateKey</a>&nbsp;privateKey,
 org.bouncycastle.cert.X509v3CertificateBuilder&nbsp;builder)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Signs the certificate being built by the given builder using the given private key and returns
 the certificate.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static byte[]</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#certAndPrivateKeyToBCFKSBytes(java.security.cert.X509Certificate,java.security.PrivateKey,char%5B%5D)" class="member-name-link">certAndPrivateKeyToBCFKSBytes</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a>&nbsp;cert,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/security/PrivateKey.html" title="class or interface in java.security" class="external-link">PrivateKey</a>&nbsp;privateKey,
 char[]&nbsp;keyPassword)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Encodes the given X509Certificate and private key as a BCFKS KeyStore, optionally protecting
 the private key (and possibly the cert?) with a password.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>private static byte[]</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#certAndPrivateKeyToBytes(java.security.cert.X509Certificate,java.security.PrivateKey,char%5B%5D,java.security.KeyStore)" class="member-name-link">certAndPrivateKeyToBytes</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a>&nbsp;cert,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/security/PrivateKey.html" title="class or interface in java.security" class="external-link">PrivateKey</a>&nbsp;privateKey,
 char[]&nbsp;keyPassword,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/security/KeyStore.html" title="class or interface in java.security" class="external-link">KeyStore</a>&nbsp;keyStore)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static byte[]</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#certAndPrivateKeyToJavaKeyStoreBytes(java.security.cert.X509Certificate,java.security.PrivateKey,char%5B%5D)" class="member-name-link">certAndPrivateKeyToJavaKeyStoreBytes</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a>&nbsp;cert,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/security/PrivateKey.html" title="class or interface in java.security" class="external-link">PrivateKey</a>&nbsp;privateKey,
 char[]&nbsp;keyPassword)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Encodes the given X509Certificate and private key as a JKS KeyStore, optionally protecting the
 private key (and possibly the cert?) with a password.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static byte[]</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#certAndPrivateKeyToPKCS12Bytes(java.security.cert.X509Certificate,java.security.PrivateKey,char%5B%5D)" class="member-name-link">certAndPrivateKeyToPKCS12Bytes</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a>&nbsp;cert,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/security/PrivateKey.html" title="class or interface in java.security" class="external-link">PrivateKey</a>&nbsp;privateKey,
 char[]&nbsp;keyPassword)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Encodes the given X509Certificate and private key as a PKCS12 KeyStore, optionally protecting
 the private key (and possibly the cert?) with a password.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static byte[]</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#certToBCFKSTrustStoreBytes(java.security.cert.X509Certificate,char%5B%5D)" class="member-name-link">certToBCFKSTrustStoreBytes</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a>&nbsp;cert,
 char[]&nbsp;keyPassword)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Encodes the given X509Certificate as a BCFKS TrustStore, optionally protecting the cert with a
 password (though it's unclear why one would do this since certificates only contain public
 information and do not need to be kept secret).</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static byte[]</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#certToJavaTrustStoreBytes(java.security.cert.X509Certificate,char%5B%5D)" class="member-name-link">certToJavaTrustStoreBytes</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a>&nbsp;cert,
 char[]&nbsp;keyPassword)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Encodes the given X509Certificate as a JKS TrustStore, optionally protecting the cert with a
 password (though it's unclear why one would do this since certificates only contain public
 information and do not need to be kept secret).</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static byte[]</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#certToPKCS12TrustStoreBytes(java.security.cert.X509Certificate,char%5B%5D)" class="member-name-link">certToPKCS12TrustStoreBytes</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a>&nbsp;cert,
 char[]&nbsp;keyPassword)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Encodes the given X509Certificate as a PKCS12 TrustStore, optionally protecting the cert with a
 password (though it's unclear why one would do this since certificates only contain public
 information and do not need to be kept secret).</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>private static byte[]</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#certToTrustStoreBytes(java.security.cert.X509Certificate,char%5B%5D,java.security.KeyStore)" class="member-name-link">certToTrustStoreBytes</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a>&nbsp;cert,
 char[]&nbsp;keyPassword,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/security/KeyStore.html" title="class or interface in java.security" class="external-link">KeyStore</a>&nbsp;trustStore)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/javase/8/docs/api/java/security/KeyPair.html" title="class or interface in java.security" class="external-link">KeyPair</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#generateECKeyPair()" class="member-name-link">generateECKeyPair</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Generates an elliptic curve key pair using the "secp256r1" aka "prime256v1" aka "NIST P-256"
 curve.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/javase/8/docs/api/java/security/KeyPair.html" title="class or interface in java.security" class="external-link">KeyPair</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#generateKeyPair(org.apache.hadoop.hbase.io.crypto.tls.X509KeyType)" class="member-name-link">generateKeyPair</a><wbr>(<a href="X509KeyType.html" title="enum in org.apache.hadoop.hbase.io.crypto.tls">X509KeyType</a>&nbsp;keyType)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Generates a new asymmetric key pair of the given type.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/javase/8/docs/api/java/security/KeyPair.html" title="class or interface in java.security" class="external-link">KeyPair</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#generateRSAKeyPair()" class="member-name-link">generateRSAKeyPair</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Generates an RSA key pair with a 2048-bit private key and F4 (65537) as the public exponent.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>private static org.bouncycastle.asn1.x509.GeneralNames</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#getLocalhostSubjectAltNames()" class="member-name-link">getLocalhostSubjectAltNames</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Returns subject alternative names for "localhost".</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>private static org.bouncycastle.cert.X509v3CertificateBuilder</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#initCertBuilder(org.bouncycastle.asn1.x500.X500Name,java.time.LocalDate,java.time.LocalDate,org.bouncycastle.asn1.x500.X500Name,java.security.PublicKey)" class="member-name-link">initCertBuilder</a><wbr>(org.bouncycastle.asn1.x500.X500Name&nbsp;issuer,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/time/LocalDate.html" title="class or interface in java.time" class="external-link">LocalDate</a>&nbsp;notBefore,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/time/LocalDate.html" title="class or interface in java.time" class="external-link">LocalDate</a>&nbsp;notAfter,
 org.bouncycastle.asn1.x500.X500Name&nbsp;subject,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/security/PublicKey.html" title="class or interface in java.security" class="external-link">PublicKey</a>&nbsp;subjectPublicKey)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Helper method for newSelfSignedCACert() and newCert().</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#newCert(java.security.cert.X509Certificate,java.security.KeyPair,org.bouncycastle.asn1.x500.X500Name,java.security.PublicKey)" class="member-name-link">newCert</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a>&nbsp;caCert,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/security/KeyPair.html" title="class or interface in java.security" class="external-link">KeyPair</a>&nbsp;caKeyPair,
 org.bouncycastle.asn1.x500.X500Name&nbsp;certSubject,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/security/PublicKey.html" title="class or interface in java.security" class="external-link">PublicKey</a>&nbsp;certPublicKey)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Using the private key of the given CA key pair and the Subject of the given CA cert as the
 Issuer, issues a new cert with the given subject and public key.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#newCert(java.security.cert.X509Certificate,java.security.KeyPair,org.bouncycastle.asn1.x500.X500Name,java.security.PublicKey,org.bouncycastle.asn1.x509.GeneralNames)" class="member-name-link">newCert</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a>&nbsp;caCert,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/security/KeyPair.html" title="class or interface in java.security" class="external-link">KeyPair</a>&nbsp;caKeyPair,
 org.bouncycastle.asn1.x500.X500Name&nbsp;certSubject,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/security/PublicKey.html" title="class or interface in java.security" class="external-link">PublicKey</a>&nbsp;certPublicKey,
 org.bouncycastle.asn1.x509.GeneralNames&nbsp;subjectAltNames)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Using the private key of the given CA key pair and the Subject of the given CA cert as the
 Issuer, issues a new cert with the given subject and public key.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#newSelfSignedCACert(org.bouncycastle.asn1.x500.X500Name,java.security.KeyPair)" class="member-name-link">newSelfSignedCACert</a><wbr>(org.bouncycastle.asn1.x500.X500Name&nbsp;subject,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/security/KeyPair.html" title="class or interface in java.security" class="external-link">KeyPair</a>&nbsp;keyPair)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Uses the private key of the given key pair to create a self-signed CA certificate with the
 public half of the key pair and the given subject and expiration.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#pemEncodeCertAndPrivateKey(java.security.cert.X509Certificate,java.security.PrivateKey,char%5B%5D)" class="member-name-link">pemEncodeCertAndPrivateKey</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a>&nbsp;cert,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/security/PrivateKey.html" title="class or interface in java.security" class="external-link">PrivateKey</a>&nbsp;privateKey,
 char[]&nbsp;keyPassword)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">PEM-encodes the given X509 certificate and private key (compatible with OpenSSL), optionally
 protecting the private key with a password.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#pemEncodePrivateKey(java.security.PrivateKey,char%5B%5D)" class="member-name-link">pemEncodePrivateKey</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/security/PrivateKey.html" title="class or interface in java.security" class="external-link">PrivateKey</a>&nbsp;key,
 char[]&nbsp;password)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">PEM-encodes the given private key (compatible with OpenSSL), optionally protecting it with a
 password, and returns the result as a String.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#pemEncodeX509Certificate(java.security.cert.X509Certificate)" class="member-name-link">pemEncodeX509Certificate</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a>&nbsp;cert)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">PEM-encodes the given X509 certificate (compatible with OpenSSL) and returns the result as a
 String.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#toX509Cert(org.bouncycastle.cert.X509CertificateHolder)" class="member-name-link">toX509Cert</a><wbr>(org.bouncycastle.cert.X509CertificateHolder&nbsp;certHolder)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Convenience method to convert a bouncycastle X509CertificateHolder to a java X509Certificate.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#clone--" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#equals-java.lang.Object-" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#finalize--" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#getClass--" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#hashCode--" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#notify--" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#notifyAll--" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#toString--" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait--" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait-long-" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait-long-int-" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ FIELD DETAIL =========== -->
<li>
<section class="field-details" id="field-detail">
<h2>Field Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="PRNG">
<h3>PRNG</h3>
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/security/SecureRandom.html" title="class or interface in java.security" class="external-link">SecureRandom</a></span>&nbsp;<span class="element-name"><a href="../../../../../../../src-html/org/apache/hadoop/hbase/io/crypto/tls/X509TestHelpers.html#line-84">PRNG</a></span></div>
</section>
</li>
<li>
<section class="detail" id="DEFAULT_RSA_KEY_SIZE_BITS">
<h3>DEFAULT_RSA_KEY_SIZE_BITS</h3>
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name"><a href="../../../../../../../src-html/org/apache/hadoop/hbase/io/crypto/tls/X509TestHelpers.html#line-85">DEFAULT_RSA_KEY_SIZE_BITS</a></span></div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../../../constant-values.html#org.apache.hadoop.hbase.io.crypto.tls.X509TestHelpers.DEFAULT_RSA_KEY_SIZE_BITS">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="DEFAULT_RSA_PUB_EXPONENT">
<h3>DEFAULT_RSA_PUB_EXPONENT</h3>
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/math/BigInteger.html" title="class or interface in java.math" class="external-link">BigInteger</a></span>&nbsp;<span class="element-name"><a href="../../../../../../../src-html/org/apache/hadoop/hbase/io/crypto/tls/X509TestHelpers.html#line-86">DEFAULT_RSA_PUB_EXPONENT</a></span></div>
</section>
</li>
<li>
<section class="detail" id="DEFAULT_ELLIPTIC_CURVE_NAME">
<h3>DEFAULT_ELLIPTIC_CURVE_NAME</h3>
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name"><a href="../../../../../../../src-html/org/apache/hadoop/hbase/io/crypto/tls/X509TestHelpers.html#line-87">DEFAULT_ELLIPTIC_CURVE_NAME</a></span></div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../../../constant-values.html#org.apache.hadoop.hbase.io.crypto.tls.X509TestHelpers.DEFAULT_ELLIPTIC_CURVE_NAME">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="SERIAL_NUMBER_MAX_BITS">
<h3>SERIAL_NUMBER_MAX_BITS</h3>
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name"><a href="../../../../../../../src-html/org/apache/hadoop/hbase/io/crypto/tls/X509TestHelpers.html#line-90">SERIAL_NUMBER_MAX_BITS</a></span></div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../../../constant-values.html#org.apache.hadoop.hbase.io.crypto.tls.X509TestHelpers.SERIAL_NUMBER_MAX_BITS">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;()">
<h3>X509TestHelpers</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="element-name"><a href="../../../../../../../src-html/org/apache/hadoop/hbase/io/crypto/tls/X509TestHelpers.html#line-469">X509TestHelpers</a></span>()</div>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="newSelfSignedCACert(org.bouncycastle.asn1.x500.X500Name,java.security.KeyPair)">
<h3>newSelfSignedCACert</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a></span>&nbsp;<span class="element-name"><a href="../../../../../../../src-html/org/apache/hadoop/hbase/io/crypto/tls/X509TestHelpers.html#line-103">newSelfSignedCACert</a></span><wbr><span class="parameters">(org.bouncycastle.asn1.x500.X500Name&nbsp;subject,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/security/KeyPair.html" title="class or interface in java.security" class="external-link">KeyPair</a>&nbsp;keyPair)</span>
                                           throws <span class="exceptions"><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a>,
org.bouncycastle.operator.OperatorCreationException,
<a href="https://docs.oracle.com/javase/8/docs/api/java/security/GeneralSecurityException.html" title="class or interface in java.security" class="external-link">GeneralSecurityException</a></span></div>
<div class="block">Uses the private key of the given key pair to create a self-signed CA certificate with the
 public half of the key pair and the given subject and expiration. The issuer of the new cert
 will be equal to the subject. Returns the new certificate. The returned certificate should be
 used as the trust store. The private key of the input key pair should be used to sign
 certificates that are used by test peers to establish TLS connections to each other.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>subject</code> - the subject of the new certificate being created.</dd>
<dd><code>keyPair</code> - the key pair to use. The public key will be embedded in the new certificate, and
                the private key will be used to self-sign the certificate.</dd>
<dt>Returns:</dt>
<dd>a new self-signed CA certificate.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
<dd><code>org.bouncycastle.operator.OperatorCreationException</code></dd>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/security/GeneralSecurityException.html" title="class or interface in java.security" class="external-link">GeneralSecurityException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="newCert(java.security.cert.X509Certificate,java.security.KeyPair,org.bouncycastle.asn1.x500.X500Name,java.security.PublicKey)">
<h3>newCert</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a></span>&nbsp;<span class="element-name"><a href="../../../../../../../src-html/org/apache/hadoop/hbase/io/crypto/tls/X509TestHelpers.html#line-127">newCert</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a>&nbsp;caCert,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/security/KeyPair.html" title="class or interface in java.security" class="external-link">KeyPair</a>&nbsp;caKeyPair,
 org.bouncycastle.asn1.x500.X500Name&nbsp;certSubject,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/security/PublicKey.html" title="class or interface in java.security" class="external-link">PublicKey</a>&nbsp;certPublicKey)</span>
                               throws <span class="exceptions"><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a>,
org.bouncycastle.operator.OperatorCreationException,
<a href="https://docs.oracle.com/javase/8/docs/api/java/security/GeneralSecurityException.html" title="class or interface in java.security" class="external-link">GeneralSecurityException</a></span></div>
<div class="block">Using the private key of the given CA key pair and the Subject of the given CA cert as the
 Issuer, issues a new cert with the given subject and public key. The returned certificate,
 combined with the private key half of the <code>certPublicKey</code>, should be used as the key
 store.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>caCert</code> - the certificate of the CA that's doing the signing.</dd>
<dd><code>caKeyPair</code> - the key pair of the CA. The private key will be used to sign. The public
                      key must match the public key in the <code>caCert</code>.</dd>
<dd><code>certSubject</code> - the subject field of the new cert being issued.</dd>
<dd><code>certPublicKey</code> - the public key of the new cert being issued.</dd>
<dt>Returns:</dt>
<dd>a new certificate signed by the CA's private key.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
<dd><code>org.bouncycastle.operator.OperatorCreationException</code></dd>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/security/GeneralSecurityException.html" title="class or interface in java.security" class="external-link">GeneralSecurityException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="newCert(java.security.cert.X509Certificate,java.security.KeyPair,org.bouncycastle.asn1.x500.X500Name,java.security.PublicKey,org.bouncycastle.asn1.x509.GeneralNames)">
<h3>newCert</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a></span>&nbsp;<span class="element-name"><a href="../../../../../../../src-html/org/apache/hadoop/hbase/io/crypto/tls/X509TestHelpers.html#line-146">newCert</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a>&nbsp;caCert,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/security/KeyPair.html" title="class or interface in java.security" class="external-link">KeyPair</a>&nbsp;caKeyPair,
 org.bouncycastle.asn1.x500.X500Name&nbsp;certSubject,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/security/PublicKey.html" title="class or interface in java.security" class="external-link">PublicKey</a>&nbsp;certPublicKey,
 org.bouncycastle.asn1.x509.GeneralNames&nbsp;subjectAltNames)</span>
                               throws <span class="exceptions"><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a>,
org.bouncycastle.operator.OperatorCreationException,
<a href="https://docs.oracle.com/javase/8/docs/api/java/security/GeneralSecurityException.html" title="class or interface in java.security" class="external-link">GeneralSecurityException</a></span></div>
<div class="block">Using the private key of the given CA key pair and the Subject of the given CA cert as the
 Issuer, issues a new cert with the given subject and public key. The returned certificate,
 combined with the private key half of the <code>certPublicKey</code>, should be used as the key
 store.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>caCert</code> - the certificate of the CA that's doing the signing.</dd>
<dd><code>caKeyPair</code> - the key pair of the CA. The private key will be used to sign. The public
                        key must match the public key in the <code>caCert</code>.</dd>
<dd><code>certSubject</code> - the subject field of the new cert being issued.</dd>
<dd><code>certPublicKey</code> - the public key of the new cert being issued.</dd>
<dd><code>subjectAltNames</code> - the subject alternative names to use, or null if none</dd>
<dt>Returns:</dt>
<dd>a new certificate signed by the CA's private key.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
<dd><code>org.bouncycastle.operator.OperatorCreationException</code></dd>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/security/GeneralSecurityException.html" title="class or interface in java.security" class="external-link">GeneralSecurityException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getLocalhostSubjectAltNames()">
<h3>getLocalhostSubjectAltNames</h3>
<div class="member-signature"><span class="modifiers">private static</span>&nbsp;<span class="return-type">org.bouncycastle.asn1.x509.GeneralNames</span>&nbsp;<span class="element-name"><a href="../../../../../../../src-html/org/apache/hadoop/hbase/io/crypto/tls/X509TestHelpers.html#line-172">getLocalhostSubjectAltNames</a></span>()
                                                                            throws <span class="exceptions"><a href="https://docs.oracle.com/javase/8/docs/api/java/net/UnknownHostException.html" title="class or interface in java.net" class="external-link">UnknownHostException</a></span></div>
<div class="block">Returns subject alternative names for "localhost".</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the subject alternative names for "localhost".</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/net/UnknownHostException.html" title="class or interface in java.net" class="external-link">UnknownHostException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="initCertBuilder(org.bouncycastle.asn1.x500.X500Name,java.time.LocalDate,java.time.LocalDate,org.bouncycastle.asn1.x500.X500Name,java.security.PublicKey)">
<h3>initCertBuilder</h3>
<div class="member-signature"><span class="modifiers">private static</span>&nbsp;<span class="return-type">org.bouncycastle.cert.X509v3CertificateBuilder</span>&nbsp;<span class="element-name"><a href="../../../../../../../src-html/org/apache/hadoop/hbase/io/crypto/tls/X509TestHelpers.html#line-195">initCertBuilder</a></span><wbr><span class="parameters">(org.bouncycastle.asn1.x500.X500Name&nbsp;issuer,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/time/LocalDate.html" title="class or interface in java.time" class="external-link">LocalDate</a>&nbsp;notBefore,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/time/LocalDate.html" title="class or interface in java.time" class="external-link">LocalDate</a>&nbsp;notAfter,
 org.bouncycastle.asn1.x500.X500Name&nbsp;subject,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/security/PublicKey.html" title="class or interface in java.security" class="external-link">PublicKey</a>&nbsp;subjectPublicKey)</span></div>
<div class="block">Helper method for newSelfSignedCACert() and newCert(). Initializes a X509v3CertificateBuilder
 with logic that's common to both methods.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>issuer</code> - Issuer field of the new cert.</dd>
<dd><code>notBefore</code> - date before which the new cert is not valid.</dd>
<dd><code>notAfter</code> - date after which the new cert is not valid.</dd>
<dd><code>subject</code> - Subject field of the new cert.</dd>
<dd><code>subjectPublicKey</code> - public key to store in the new cert.</dd>
<dt>Returns:</dt>
<dd>a X509v3CertificateBuilder that can be further customized to finish creating the new
         cert.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="buildAndSignCertificate(java.security.PrivateKey,org.bouncycastle.cert.X509v3CertificateBuilder)">
<h3>buildAndSignCertificate</h3>
<div class="member-signature"><span class="modifiers">private static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a></span>&nbsp;<span class="element-name"><a href="../../../../../../../src-html/org/apache/hadoop/hbase/io/crypto/tls/X509TestHelpers.html#line-209">buildAndSignCertificate</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/security/PrivateKey.html" title="class or interface in java.security" class="external-link">PrivateKey</a>&nbsp;privateKey,
 org.bouncycastle.cert.X509v3CertificateBuilder&nbsp;builder)</span>
                                                throws <span class="exceptions"><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a>,
org.bouncycastle.operator.OperatorCreationException,
<a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/CertificateException.html" title="class or interface in java.security.cert" class="external-link">CertificateException</a></span></div>
<div class="block">Signs the certificate being built by the given builder using the given private key and returns
 the certificate.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>privateKey</code> - the private key to sign the certificate with.</dd>
<dd><code>builder</code> - the cert builder that contains the certificate data.</dd>
<dt>Returns:</dt>
<dd>the signed certificate.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
<dd><code>org.bouncycastle.operator.OperatorCreationException</code></dd>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/CertificateException.html" title="class or interface in java.security.cert" class="external-link">CertificateException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="generateKeyPair(org.apache.hadoop.hbase.io.crypto.tls.X509KeyType)">
<h3>generateKeyPair</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/security/KeyPair.html" title="class or interface in java.security" class="external-link">KeyPair</a></span>&nbsp;<span class="element-name"><a href="../../../../../../../src-html/org/apache/hadoop/hbase/io/crypto/tls/X509TestHelpers.html#line-238">generateKeyPair</a></span><wbr><span class="parameters">(<a href="X509KeyType.html" title="enum in org.apache.hadoop.hbase.io.crypto.tls">X509KeyType</a>&nbsp;keyType)</span>
                               throws <span class="exceptions"><a href="https://docs.oracle.com/javase/8/docs/api/java/security/GeneralSecurityException.html" title="class or interface in java.security" class="external-link">GeneralSecurityException</a></span></div>
<div class="block">Generates a new asymmetric key pair of the given type.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>keyType</code> - the type of key pair to generate.</dd>
<dt>Returns:</dt>
<dd>the new key pair.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/security/GeneralSecurityException.html" title="class or interface in java.security" class="external-link">GeneralSecurityException</a></code> - if your java crypto providers are messed up.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="generateRSAKeyPair()">
<h3>generateRSAKeyPair</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/security/KeyPair.html" title="class or interface in java.security" class="external-link">KeyPair</a></span>&nbsp;<span class="element-name"><a href="../../../../../../../src-html/org/apache/hadoop/hbase/io/crypto/tls/X509TestHelpers.html#line-253">generateRSAKeyPair</a></span>()
                                  throws <span class="exceptions"><a href="https://docs.oracle.com/javase/8/docs/api/java/security/GeneralSecurityException.html" title="class or interface in java.security" class="external-link">GeneralSecurityException</a></span></div>
<div class="block">Generates an RSA key pair with a 2048-bit private key and F4 (65537) as the public exponent.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the key pair.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/security/GeneralSecurityException.html" title="class or interface in java.security" class="external-link">GeneralSecurityException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="generateECKeyPair()">
<h3>generateECKeyPair</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/security/KeyPair.html" title="class or interface in java.security" class="external-link">KeyPair</a></span>&nbsp;<span class="element-name"><a href="../../../../../../../src-html/org/apache/hadoop/hbase/io/crypto/tls/X509TestHelpers.html#line-266">generateECKeyPair</a></span>()
                                 throws <span class="exceptions"><a href="https://docs.oracle.com/javase/8/docs/api/java/security/GeneralSecurityException.html" title="class or interface in java.security" class="external-link">GeneralSecurityException</a></span></div>
<div class="block">Generates an elliptic curve key pair using the "secp256r1" aka "prime256v1" aka "NIST P-256"
 curve.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the key pair.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/security/GeneralSecurityException.html" title="class or interface in java.security" class="external-link">GeneralSecurityException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="pemEncodeCertAndPrivateKey(java.security.cert.X509Certificate,java.security.PrivateKey,char[])">
<h3>pemEncodeCertAndPrivateKey</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name"><a href="../../../../../../../src-html/org/apache/hadoop/hbase/io/crypto/tls/X509TestHelpers.html#line-285">pemEncodeCertAndPrivateKey</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a>&nbsp;cert,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/security/PrivateKey.html" title="class or interface in java.security" class="external-link">PrivateKey</a>&nbsp;privateKey,
 char[]&nbsp;keyPassword)</span>
                                         throws <span class="exceptions"><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a>,
org.bouncycastle.operator.OperatorCreationException</span></div>
<div class="block">PEM-encodes the given X509 certificate and private key (compatible with OpenSSL), optionally
 protecting the private key with a password. Concatenates them both and returns the result as a
 single string. This creates the PEM encoding of a key store.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>cert</code> - the X509 certificate to PEM-encode.</dd>
<dd><code>privateKey</code> - the private key to PEM-encode.</dd>
<dd><code>keyPassword</code> - an optional key password. If empty or null, the private key will not be
                    encrypted.</dd>
<dt>Returns:</dt>
<dd>a String containing the PEM encodings of the certificate and private key.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - if converting the certificate or private key to PEM format
                                   fails.</dd>
<dd><code>org.bouncycastle.operator.OperatorCreationException</code> - if constructing the encryptor from the given password fails.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="pemEncodePrivateKey(java.security.PrivateKey,char[])">
<h3>pemEncodePrivateKey</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name"><a href="../../../../../../../src-html/org/apache/hadoop/hbase/io/crypto/tls/X509TestHelpers.html#line-300">pemEncodePrivateKey</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/security/PrivateKey.html" title="class or interface in java.security" class="external-link">PrivateKey</a>&nbsp;key,
 char[]&nbsp;password)</span>
                                  throws <span class="exceptions"><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a>,
org.bouncycastle.operator.OperatorCreationException</span></div>
<div class="block">PEM-encodes the given private key (compatible with OpenSSL), optionally protecting it with a
 password, and returns the result as a String.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>key</code> - the private key.</dd>
<dd><code>password</code> - an optional key password. If empty or null, the private key will not be
                 encrypted.</dd>
<dt>Returns:</dt>
<dd>a String containing the PEM encoding of the private key.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - if converting the key to PEM format fails.</dd>
<dd><code>org.bouncycastle.operator.OperatorCreationException</code> - if constructing the encryptor from the given password fails.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="pemEncodeX509Certificate(java.security.cert.X509Certificate)">
<h3>pemEncodeX509Certificate</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name"><a href="../../../../../../../src-html/org/apache/hadoop/hbase/io/crypto/tls/X509TestHelpers.html#line-323">pemEncodeX509Certificate</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a>&nbsp;cert)</span>
                                       throws <span class="exceptions"><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">PEM-encodes the given X509 certificate (compatible with OpenSSL) and returns the result as a
 String.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>cert</code> - the certificate.</dd>
<dt>Returns:</dt>
<dd>a String containing the PEM encoding of the certificate.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - if converting the certificate to PEM format fails.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="certToJavaTrustStoreBytes(java.security.cert.X509Certificate,char[])">
<h3>certToJavaTrustStoreBytes</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name"><a href="../../../../../../../src-html/org/apache/hadoop/hbase/io/crypto/tls/X509TestHelpers.html#line-342">certToJavaTrustStoreBytes</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a>&nbsp;cert,
 char[]&nbsp;keyPassword)</span>
                                        throws <span class="exceptions"><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a>,
<a href="https://docs.oracle.com/javase/8/docs/api/java/security/GeneralSecurityException.html" title="class or interface in java.security" class="external-link">GeneralSecurityException</a></span></div>
<div class="block">Encodes the given X509Certificate as a JKS TrustStore, optionally protecting the cert with a
 password (though it's unclear why one would do this since certificates only contain public
 information and do not need to be kept secret). Returns the byte array encoding of the trust
 store, which may be written to a file and loaded to instantiate the trust store at a later
 point or in another process.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>cert</code> - the certificate to serialize.</dd>
<dd><code>keyPassword</code> - an optional password to encrypt the trust store. If empty or null, the cert
                    will not be encrypted.</dd>
<dt>Returns:</dt>
<dd>the serialized bytes of the JKS trust store.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/security/GeneralSecurityException.html" title="class or interface in java.security" class="external-link">GeneralSecurityException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="certToPKCS12TrustStoreBytes(java.security.cert.X509Certificate,char[])">
<h3>certToPKCS12TrustStoreBytes</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name"><a href="../../../../../../../src-html/org/apache/hadoop/hbase/io/crypto/tls/X509TestHelpers.html#line-359">certToPKCS12TrustStoreBytes</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a>&nbsp;cert,
 char[]&nbsp;keyPassword)</span>
                                          throws <span class="exceptions"><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a>,
<a href="https://docs.oracle.com/javase/8/docs/api/java/security/GeneralSecurityException.html" title="class or interface in java.security" class="external-link">GeneralSecurityException</a></span></div>
<div class="block">Encodes the given X509Certificate as a PKCS12 TrustStore, optionally protecting the cert with a
 password (though it's unclear why one would do this since certificates only contain public
 information and do not need to be kept secret). Returns the byte array encoding of the trust
 store, which may be written to a file and loaded to instantiate the trust store at a later
 point or in another process.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>cert</code> - the certificate to serialize.</dd>
<dd><code>keyPassword</code> - an optional password to encrypt the trust store. If empty or null, the cert
                    will not be encrypted.</dd>
<dt>Returns:</dt>
<dd>the serialized bytes of the PKCS12 trust store.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/security/GeneralSecurityException.html" title="class or interface in java.security" class="external-link">GeneralSecurityException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="certToBCFKSTrustStoreBytes(java.security.cert.X509Certificate,char[])">
<h3>certToBCFKSTrustStoreBytes</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name"><a href="../../../../../../../src-html/org/apache/hadoop/hbase/io/crypto/tls/X509TestHelpers.html#line-376">certToBCFKSTrustStoreBytes</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a>&nbsp;cert,
 char[]&nbsp;keyPassword)</span>
                                         throws <span class="exceptions"><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a>,
<a href="https://docs.oracle.com/javase/8/docs/api/java/security/GeneralSecurityException.html" title="class or interface in java.security" class="external-link">GeneralSecurityException</a></span></div>
<div class="block">Encodes the given X509Certificate as a BCFKS TrustStore, optionally protecting the cert with a
 password (though it's unclear why one would do this since certificates only contain public
 information and do not need to be kept secret). Returns the byte array encoding of the trust
 store, which may be written to a file and loaded to instantiate the trust store at a later
 point or in another process.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>cert</code> - the certificate to serialize.</dd>
<dd><code>keyPassword</code> - an optional password to encrypt the trust store. If empty or null, the cert
                    will not be encrypted.</dd>
<dt>Returns:</dt>
<dd>the serialized bytes of the BCFKS trust store.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/security/GeneralSecurityException.html" title="class or interface in java.security" class="external-link">GeneralSecurityException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="certToTrustStoreBytes(java.security.cert.X509Certificate,char[],java.security.KeyStore)">
<h3>certToTrustStoreBytes</h3>
<div class="member-signature"><span class="modifiers">private static</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name"><a href="../../../../../../../src-html/org/apache/hadoop/hbase/io/crypto/tls/X509TestHelpers.html#line-382">certToTrustStoreBytes</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a>&nbsp;cert,
 char[]&nbsp;keyPassword,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/security/KeyStore.html" title="class or interface in java.security" class="external-link">KeyStore</a>&nbsp;trustStore)</span>
                                     throws <span class="exceptions"><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a>,
<a href="https://docs.oracle.com/javase/8/docs/api/java/security/GeneralSecurityException.html" title="class or interface in java.security" class="external-link">GeneralSecurityException</a></span></div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/security/GeneralSecurityException.html" title="class or interface in java.security" class="external-link">GeneralSecurityException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="certAndPrivateKeyToJavaKeyStoreBytes(java.security.cert.X509Certificate,java.security.PrivateKey,char[])">
<h3>certAndPrivateKeyToJavaKeyStoreBytes</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name"><a href="../../../../../../../src-html/org/apache/hadoop/hbase/io/crypto/tls/X509TestHelpers.html#line-405">certAndPrivateKeyToJavaKeyStoreBytes</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a>&nbsp;cert,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/security/PrivateKey.html" title="class or interface in java.security" class="external-link">PrivateKey</a>&nbsp;privateKey,
 char[]&nbsp;keyPassword)</span>
                                                   throws <span class="exceptions"><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a>,
<a href="https://docs.oracle.com/javase/8/docs/api/java/security/GeneralSecurityException.html" title="class or interface in java.security" class="external-link">GeneralSecurityException</a></span></div>
<div class="block">Encodes the given X509Certificate and private key as a JKS KeyStore, optionally protecting the
 private key (and possibly the cert?) with a password. Returns the byte array encoding of the
 key store, which may be written to a file and loaded to instantiate the key store at a later
 point or in another process.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>cert</code> - the X509 certificate to serialize.</dd>
<dd><code>privateKey</code> - the private key to serialize.</dd>
<dd><code>keyPassword</code> - an optional key password. If empty or null, the private key will not be
                    encrypted.</dd>
<dt>Returns:</dt>
<dd>the serialized bytes of the JKS key store.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/security/GeneralSecurityException.html" title="class or interface in java.security" class="external-link">GeneralSecurityException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="certAndPrivateKeyToPKCS12Bytes(java.security.cert.X509Certificate,java.security.PrivateKey,char[])">
<h3>certAndPrivateKeyToPKCS12Bytes</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name"><a href="../../../../../../../src-html/org/apache/hadoop/hbase/io/crypto/tls/X509TestHelpers.html#line-422">certAndPrivateKeyToPKCS12Bytes</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a>&nbsp;cert,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/security/PrivateKey.html" title="class or interface in java.security" class="external-link">PrivateKey</a>&nbsp;privateKey,
 char[]&nbsp;keyPassword)</span>
                                             throws <span class="exceptions"><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a>,
<a href="https://docs.oracle.com/javase/8/docs/api/java/security/GeneralSecurityException.html" title="class or interface in java.security" class="external-link">GeneralSecurityException</a></span></div>
<div class="block">Encodes the given X509Certificate and private key as a PKCS12 KeyStore, optionally protecting
 the private key (and possibly the cert?) with a password. Returns the byte array encoding of
 the key store, which may be written to a file and loaded to instantiate the key store at a
 later point or in another process.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>cert</code> - the X509 certificate to serialize.</dd>
<dd><code>privateKey</code> - the private key to serialize.</dd>
<dd><code>keyPassword</code> - an optional key password. If empty or null, the private key will not be
                    encrypted.</dd>
<dt>Returns:</dt>
<dd>the serialized bytes of the PKCS12 key store.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/security/GeneralSecurityException.html" title="class or interface in java.security" class="external-link">GeneralSecurityException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="certAndPrivateKeyToBCFKSBytes(java.security.cert.X509Certificate,java.security.PrivateKey,char[])">
<h3>certAndPrivateKeyToBCFKSBytes</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name"><a href="../../../../../../../src-html/org/apache/hadoop/hbase/io/crypto/tls/X509TestHelpers.html#line-439">certAndPrivateKeyToBCFKSBytes</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a>&nbsp;cert,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/security/PrivateKey.html" title="class or interface in java.security" class="external-link">PrivateKey</a>&nbsp;privateKey,
 char[]&nbsp;keyPassword)</span>
                                            throws <span class="exceptions"><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a>,
<a href="https://docs.oracle.com/javase/8/docs/api/java/security/GeneralSecurityException.html" title="class or interface in java.security" class="external-link">GeneralSecurityException</a></span></div>
<div class="block">Encodes the given X509Certificate and private key as a BCFKS KeyStore, optionally protecting
 the private key (and possibly the cert?) with a password. Returns the byte array encoding of
 the key store, which may be written to a file and loaded to instantiate the key store at a
 later point or in another process.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>cert</code> - the X509 certificate to serialize.</dd>
<dd><code>privateKey</code> - the private key to serialize.</dd>
<dd><code>keyPassword</code> - an optional key password. If empty or null, the private key will not be
                    encrypted.</dd>
<dt>Returns:</dt>
<dd>the serialized bytes of the BCFKS key store.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/security/GeneralSecurityException.html" title="class or interface in java.security" class="external-link">GeneralSecurityException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="certAndPrivateKeyToBytes(java.security.cert.X509Certificate,java.security.PrivateKey,char[],java.security.KeyStore)">
<h3>certAndPrivateKeyToBytes</h3>
<div class="member-signature"><span class="modifiers">private static</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name"><a href="../../../../../../../src-html/org/apache/hadoop/hbase/io/crypto/tls/X509TestHelpers.html#line-445">certAndPrivateKeyToBytes</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a>&nbsp;cert,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/security/PrivateKey.html" title="class or interface in java.security" class="external-link">PrivateKey</a>&nbsp;privateKey,
 char[]&nbsp;keyPassword,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/security/KeyStore.html" title="class or interface in java.security" class="external-link">KeyStore</a>&nbsp;keyStore)</span>
                                        throws <span class="exceptions"><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a>,
<a href="https://docs.oracle.com/javase/8/docs/api/java/security/GeneralSecurityException.html" title="class or interface in java.security" class="external-link">GeneralSecurityException</a></span></div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/security/GeneralSecurityException.html" title="class or interface in java.security" class="external-link">GeneralSecurityException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="toX509Cert(org.bouncycastle.cert.X509CertificateHolder)">
<h3>toX509Cert</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/X509Certificate.html" title="class or interface in java.security.cert" class="external-link">X509Certificate</a></span>&nbsp;<span class="element-name"><a href="../../../../../../../src-html/org/apache/hadoop/hbase/io/crypto/tls/X509TestHelpers.html#line-463">toX509Cert</a></span><wbr><span class="parameters">(org.bouncycastle.cert.X509CertificateHolder&nbsp;certHolder)</span>
                                  throws <span class="exceptions"><a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/CertificateException.html" title="class or interface in java.security.cert" class="external-link">CertificateException</a></span></div>
<div class="block">Convenience method to convert a bouncycastle X509CertificateHolder to a java X509Certificate.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>certHolder</code> - a bouncycastle X509CertificateHolder.</dd>
<dt>Returns:</dt>
<dd>a java X509Certificate</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/security/cert/CertificateException.html" title="class or interface in java.security.cert" class="external-link">CertificateException</a></code> - if the conversion fails.</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Copyright &#169; 2007&#x2013;2020 <a href="https://www.apache.org/">The Apache Software Foundation</a>. All rights reserved.</small></p>
</footer>
</div>
</div>
</body>
</html>
