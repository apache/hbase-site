<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
<head>
<title>Source code</title>
<link rel="stylesheet" type="text/css" href="../../../../../../../stylesheet.css" title="Style">
</head>
<body>
<div class="sourceContainer">
<pre><span class="sourceLineNo">001</span>// Autogenerated Jamon implementation<a name="line.1"></a>
<span class="sourceLineNo">002</span>// /Users/peter.somogyi/Cloudera/repos/hbase-upstream/hbase-server/src/main/jamon/org/apache/hadoop/hbase/tmpl/regionserver/ReplicationStatusTmpl.jamon<a name="line.2"></a>
<span class="sourceLineNo">003</span><a name="line.3"></a>
<span class="sourceLineNo">004</span>package org.apache.hadoop.hbase.tmpl.regionserver;<a name="line.4"></a>
<span class="sourceLineNo">005</span><a name="line.5"></a>
<span class="sourceLineNo">006</span>// 23, 9<a name="line.6"></a>
<span class="sourceLineNo">007</span>import java.util.*;<a name="line.7"></a>
<span class="sourceLineNo">008</span>// 24, 9<a name="line.8"></a>
<span class="sourceLineNo">009</span>import java.util.Map.Entry;<a name="line.9"></a>
<span class="sourceLineNo">010</span>// 25, 9<a name="line.10"></a>
<span class="sourceLineNo">011</span>import org.apache.hadoop.hbase.procedure2.util.StringUtils;<a name="line.11"></a>
<span class="sourceLineNo">012</span>// 26, 9<a name="line.12"></a>
<span class="sourceLineNo">013</span>import org.apache.hadoop.hbase.regionserver.HRegionServer;<a name="line.13"></a>
<span class="sourceLineNo">014</span>// 27, 9<a name="line.14"></a>
<span class="sourceLineNo">015</span>import org.apache.hadoop.hbase.replication.regionserver.ReplicationStatus;<a name="line.15"></a>
<span class="sourceLineNo">016</span><a name="line.16"></a>
<span class="sourceLineNo">017</span>public class ReplicationStatusTmplImpl<a name="line.17"></a>
<span class="sourceLineNo">018</span>  extends org.jamon.AbstractTemplateImpl<a name="line.18"></a>
<span class="sourceLineNo">019</span>  implements org.apache.hadoop.hbase.tmpl.regionserver.ReplicationStatusTmpl.Intf<a name="line.19"></a>
<span class="sourceLineNo">020</span><a name="line.20"></a>
<span class="sourceLineNo">021</span>{<a name="line.21"></a>
<span class="sourceLineNo">022</span>  private final HRegionServer regionServer;<a name="line.22"></a>
<span class="sourceLineNo">023</span>  protected static org.apache.hadoop.hbase.tmpl.regionserver.ReplicationStatusTmpl.ImplData __jamon_setOptionalArguments(org.apache.hadoop.hbase.tmpl.regionserver.ReplicationStatusTmpl.ImplData p_implData)<a name="line.23"></a>
<span class="sourceLineNo">024</span>  {<a name="line.24"></a>
<span class="sourceLineNo">025</span>    return p_implData;<a name="line.25"></a>
<span class="sourceLineNo">026</span>  }<a name="line.26"></a>
<span class="sourceLineNo">027</span>  public ReplicationStatusTmplImpl(org.jamon.TemplateManager p_templateManager, org.apache.hadoop.hbase.tmpl.regionserver.ReplicationStatusTmpl.ImplData p_implData)<a name="line.27"></a>
<span class="sourceLineNo">028</span>  {<a name="line.28"></a>
<span class="sourceLineNo">029</span>    super(p_templateManager, __jamon_setOptionalArguments(p_implData));<a name="line.29"></a>
<span class="sourceLineNo">030</span>    regionServer = p_implData.getRegionServer();<a name="line.30"></a>
<span class="sourceLineNo">031</span>  }<a name="line.31"></a>
<span class="sourceLineNo">032</span>  <a name="line.32"></a>
<span class="sourceLineNo">033</span>  @Override public void renderNoFlush(final java.io.Writer jamonWriter)<a name="line.33"></a>
<span class="sourceLineNo">034</span>    throws java.io.IOException<a name="line.34"></a>
<span class="sourceLineNo">035</span>  {<a name="line.35"></a>
<span class="sourceLineNo">036</span>    // 30, 1<a name="line.36"></a>
<span class="sourceLineNo">037</span>    <a name="line.37"></a>
<span class="sourceLineNo">038</span>        Map&lt;String, ReplicationStatus&gt; walGroupsReplicationStatus = regionServer.getWalGroupsReplicationStatus();<a name="line.38"></a>
<span class="sourceLineNo">039</span><a name="line.39"></a>
<span class="sourceLineNo">040</span>    // 34, 1<a name="line.40"></a>
<span class="sourceLineNo">041</span>    if ((walGroupsReplicationStatus != null &amp;&amp; walGroupsReplicationStatus.size() &gt; 0) )<a name="line.41"></a>
<span class="sourceLineNo">042</span>    {<a name="line.42"></a>
<span class="sourceLineNo">043</span>      // 34, 86<a name="line.43"></a>
<span class="sourceLineNo">044</span>      jamonWriter.write("\n\n    &lt;div class=\"tabbable\"&gt;\n        &lt;ul class=\"nav nav-pills\"&gt;\n            &lt;li class=\"active\"&gt;&lt;a href=\"#tab_currentLog\" data-toggle=\"tab\"&gt;Current Log&lt;/a&gt; &lt;/li&gt;\n            &lt;li class=\"\"&gt;&lt;a href=\"#tab_replicationDelay\" data-toggle=\"tab\"&gt;Replication Delay&lt;/a&gt;&lt;/li&gt;\n        &lt;/ul&gt;\n        &lt;div class=\"tab-content\" style=\"padding-bottom: 9px; border-bottom: 1px solid #ddd;\"&gt;\n            &lt;div class=\"tab-pane active\" id=\"tab_currentLog\"&gt;\n                ");<a name="line.44"></a>
<span class="sourceLineNo">045</span>      // 43, 17<a name="line.45"></a>
<span class="sourceLineNo">046</span>      {<a name="line.46"></a>
<span class="sourceLineNo">047</span>        // 43, 17<a name="line.47"></a>
<span class="sourceLineNo">048</span>        __jamon_innerUnit__currentLog(jamonWriter, walGroupsReplicationStatus);<a name="line.48"></a>
<span class="sourceLineNo">049</span>      }<a name="line.49"></a>
<span class="sourceLineNo">050</span>      // 43, 72<a name="line.50"></a>
<span class="sourceLineNo">051</span>      jamonWriter.write("\n            &lt;/div&gt;\n            &lt;div class=\"tab-pane\" id=\"tab_replicationDelay\"&gt;\n                ");<a name="line.51"></a>
<span class="sourceLineNo">052</span>      // 46, 17<a name="line.52"></a>
<span class="sourceLineNo">053</span>      {<a name="line.53"></a>
<span class="sourceLineNo">054</span>        // 46, 17<a name="line.54"></a>
<span class="sourceLineNo">055</span>        __jamon_innerUnit__replicationDelay(jamonWriter, walGroupsReplicationStatus);<a name="line.55"></a>
<span class="sourceLineNo">056</span>      }<a name="line.56"></a>
<span class="sourceLineNo">057</span>      // 46, 78<a name="line.57"></a>
<span class="sourceLineNo">058</span>      jamonWriter.write("\n            &lt;/div&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n    &lt;p&gt; If the replication delay is UNKNOWN, that means this walGroup doesn't start replicate yet and it may get disabled.\n    If the size of log is 0, it means we are replicating current HLog, thus we can't get accurate size since it's not closed yet.&lt;/p&gt;\n\n");<a name="line.58"></a>
<span class="sourceLineNo">059</span>    }<a name="line.59"></a>
<span class="sourceLineNo">060</span>    // 53, 1<a name="line.60"></a>
<span class="sourceLineNo">061</span>    else<a name="line.61"></a>
<span class="sourceLineNo">062</span>    {<a name="line.62"></a>
<span class="sourceLineNo">063</span>      // 53, 8<a name="line.63"></a>
<span class="sourceLineNo">064</span>      jamonWriter.write("\n    &lt;p&gt;No Replication Metrics for Peers&lt;/p&gt;\n");<a name="line.64"></a>
<span class="sourceLineNo">065</span>    }<a name="line.65"></a>
<span class="sourceLineNo">066</span>    // 55, 7<a name="line.66"></a>
<span class="sourceLineNo">067</span>    jamonWriter.write("\n\n");<a name="line.67"></a>
<span class="sourceLineNo">068</span>  }<a name="line.68"></a>
<span class="sourceLineNo">069</span>  <a name="line.69"></a>
<span class="sourceLineNo">070</span>  <a name="line.70"></a>
<span class="sourceLineNo">071</span>  // 57, 1<a name="line.71"></a>
<span class="sourceLineNo">072</span>  private void __jamon_innerUnit__currentLog(final java.io.Writer jamonWriter, final Map&lt;String,ReplicationStatus&gt; metrics)<a name="line.72"></a>
<span class="sourceLineNo">073</span>    throws java.io.IOException<a name="line.73"></a>
<span class="sourceLineNo">074</span>  {<a name="line.74"></a>
<span class="sourceLineNo">075</span>    // 61, 5<a name="line.75"></a>
<span class="sourceLineNo">076</span>    jamonWriter.write("&lt;table class=\"table table-striped\"&gt;\n        &lt;tr&gt;\n            &lt;th&gt;PeerId&lt;/th&gt;\n            &lt;th&gt;WalGroup&lt;/th&gt;\n            &lt;th&gt;Current Log&lt;/th&gt;\n            &lt;th&gt;Size&lt;/th&gt;\n            &lt;th&gt;Queue Size&lt;/th&gt;\n            &lt;th&gt;Offset&lt;/th&gt;\n        &lt;/tr&gt;\n            ");<a name="line.76"></a>
<span class="sourceLineNo">077</span>    // 70, 13<a name="line.77"></a>
<span class="sourceLineNo">078</span>    for (Map.Entry&lt;String, ReplicationStatus&gt; entry: metrics.entrySet() )<a name="line.78"></a>
<span class="sourceLineNo">079</span>    {<a name="line.79"></a>
<span class="sourceLineNo">080</span>      // 70, 84<a name="line.80"></a>
<span class="sourceLineNo">081</span>      jamonWriter.write("\n                 &lt;tr&gt;\n                     &lt;td&gt;");<a name="line.81"></a>
<span class="sourceLineNo">082</span>      // 72, 26<a name="line.82"></a>
<span class="sourceLineNo">083</span>      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(entry.getValue().getPeerId()), jamonWriter);<a name="line.83"></a>
<span class="sourceLineNo">084</span>      // 72, 60<a name="line.84"></a>
<span class="sourceLineNo">085</span>      jamonWriter.write("&lt;/td&gt;\n                     &lt;td&gt;");<a name="line.85"></a>
<span class="sourceLineNo">086</span>      // 73, 26<a name="line.86"></a>
<span class="sourceLineNo">087</span>      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(entry.getValue().getWalGroup()), jamonWriter);<a name="line.87"></a>
<span class="sourceLineNo">088</span>      // 73, 62<a name="line.88"></a>
<span class="sourceLineNo">089</span>      jamonWriter.write("&lt;/td&gt;\n                     &lt;td&gt;");<a name="line.89"></a>
<span class="sourceLineNo">090</span>      // 74, 26<a name="line.90"></a>
<span class="sourceLineNo">091</span>      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(entry.getValue().getCurrentPath()), jamonWriter);<a name="line.91"></a>
<span class="sourceLineNo">092</span>      // 74, 65<a name="line.92"></a>
<span class="sourceLineNo">093</span>      jamonWriter.write(" &lt;/td&gt;\n                     &lt;td&gt;");<a name="line.93"></a>
<span class="sourceLineNo">094</span>      // 75, 26<a name="line.94"></a>
<span class="sourceLineNo">095</span>      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(StringUtils.humanSize(entry.getValue().getFileSize())), jamonWriter);<a name="line.95"></a>
<span class="sourceLineNo">096</span>      // 75, 85<a name="line.96"></a>
<span class="sourceLineNo">097</span>      jamonWriter.write("&lt;/td&gt;\n                     &lt;td&gt;");<a name="line.97"></a>
<span class="sourceLineNo">098</span>      // 76, 26<a name="line.98"></a>
<span class="sourceLineNo">099</span>      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(entry.getValue().getQueueSize()), jamonWriter);<a name="line.99"></a>
<span class="sourceLineNo">100</span>      // 76, 63<a name="line.100"></a>
<span class="sourceLineNo">101</span>      jamonWriter.write("&lt;/td&gt;\n                     &lt;td&gt;");<a name="line.101"></a>
<span class="sourceLineNo">102</span>      // 77, 26<a name="line.102"></a>
<span class="sourceLineNo">103</span>      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(StringUtils.humanSize(entry.getValue().getCurrentPosition())), jamonWriter);<a name="line.103"></a>
<span class="sourceLineNo">104</span>      // 77, 92<a name="line.104"></a>
<span class="sourceLineNo">105</span>      jamonWriter.write("&lt;/td&gt;\n                 &lt;/tr&gt;\n            ");<a name="line.105"></a>
<span class="sourceLineNo">106</span>    }<a name="line.106"></a>
<span class="sourceLineNo">107</span>    // 79, 20<a name="line.107"></a>
<span class="sourceLineNo">108</span>    jamonWriter.write("\n    &lt;/table&gt;\n");<a name="line.108"></a>
<span class="sourceLineNo">109</span>  }<a name="line.109"></a>
<span class="sourceLineNo">110</span>  <a name="line.110"></a>
<span class="sourceLineNo">111</span>  <a name="line.111"></a>
<span class="sourceLineNo">112</span>  // 83, 1<a name="line.112"></a>
<span class="sourceLineNo">113</span>  private void __jamon_innerUnit__replicationDelay(final java.io.Writer jamonWriter, final Map&lt;String,ReplicationStatus&gt; metrics)<a name="line.113"></a>
<span class="sourceLineNo">114</span>    throws java.io.IOException<a name="line.114"></a>
<span class="sourceLineNo">115</span>  {<a name="line.115"></a>
<span class="sourceLineNo">116</span>    // 87, 5<a name="line.116"></a>
<span class="sourceLineNo">117</span>    jamonWriter.write("&lt;table class=\"table table-striped\"&gt;\n        &lt;tr&gt;\n            &lt;th&gt;PeerId&lt;/th&gt;\n            &lt;th&gt;WalGroup&lt;/th&gt;\n            &lt;th&gt;Current Log&lt;/th&gt;\n            &lt;th&gt;Last Shipped Age&lt;/th&gt;\n            &lt;th&gt;Replication Delay&lt;/th&gt;\n        &lt;/tr&gt;\n            ");<a name="line.117"></a>
<span class="sourceLineNo">118</span>    // 95, 13<a name="line.118"></a>
<span class="sourceLineNo">119</span>    for (Map.Entry&lt;String, ReplicationStatus&gt; entry: metrics.entrySet() )<a name="line.119"></a>
<span class="sourceLineNo">120</span>    {<a name="line.120"></a>
<span class="sourceLineNo">121</span>      // 95, 84<a name="line.121"></a>
<span class="sourceLineNo">122</span>      jamonWriter.write("\n                 &lt;tr&gt;\n                     &lt;td&gt;");<a name="line.122"></a>
<span class="sourceLineNo">123</span>      // 97, 26<a name="line.123"></a>
<span class="sourceLineNo">124</span>      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(entry.getValue().getPeerId()), jamonWriter);<a name="line.124"></a>
<span class="sourceLineNo">125</span>      // 97, 60<a name="line.125"></a>
<span class="sourceLineNo">126</span>      jamonWriter.write("&lt;/td&gt;\n                     &lt;td&gt;");<a name="line.126"></a>
<span class="sourceLineNo">127</span>      // 98, 26<a name="line.127"></a>
<span class="sourceLineNo">128</span>      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(entry.getValue().getWalGroup()), jamonWriter);<a name="line.128"></a>
<span class="sourceLineNo">129</span>      // 98, 62<a name="line.129"></a>
<span class="sourceLineNo">130</span>      jamonWriter.write("&lt;/td&gt;\n                     &lt;td&gt;");<a name="line.130"></a>
<span class="sourceLineNo">131</span>      // 99, 26<a name="line.131"></a>
<span class="sourceLineNo">132</span>      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(entry.getValue().getCurrentPath()), jamonWriter);<a name="line.132"></a>
<span class="sourceLineNo">133</span>      // 99, 65<a name="line.133"></a>
<span class="sourceLineNo">134</span>      jamonWriter.write(" &lt;/td&gt;\n                     &lt;td&gt;");<a name="line.134"></a>
<span class="sourceLineNo">135</span>      // 100, 26<a name="line.135"></a>
<span class="sourceLineNo">136</span>      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(StringUtils.humanTimeDiff(entry.getValue().getAgeOfLastShippedOp())), jamonWriter);<a name="line.136"></a>
<span class="sourceLineNo">137</span>      // 100, 99<a name="line.137"></a>
<span class="sourceLineNo">138</span>      jamonWriter.write("&lt;/td&gt;\n                     &lt;td&gt;");<a name="line.138"></a>
<span class="sourceLineNo">139</span>      // 101, 26<a name="line.139"></a>
<span class="sourceLineNo">140</span>      org.jamon.escaping.Escaping.HTML.write(org.jamon.emit.StandardEmitter.valueOf(entry.getValue().getReplicationDelay() == Long.MAX_VALUE ? "UNKNOWN" : StringUtils.humanTimeDiff(entry.getValue().getReplicationDelay())), jamonWriter);<a name="line.140"></a>
<span class="sourceLineNo">141</span>      // 101, 168<a name="line.141"></a>
<span class="sourceLineNo">142</span>      jamonWriter.write("&lt;/td&gt;\n                 &lt;/tr&gt;\n            ");<a name="line.142"></a>
<span class="sourceLineNo">143</span>    }<a name="line.143"></a>
<span class="sourceLineNo">144</span>    // 103, 20<a name="line.144"></a>
<span class="sourceLineNo">145</span>    jamonWriter.write("\n    &lt;/table&gt;\n");<a name="line.145"></a>
<span class="sourceLineNo">146</span>  }<a name="line.146"></a>
<span class="sourceLineNo">147</span>  <a name="line.147"></a>
<span class="sourceLineNo">148</span>  <a name="line.148"></a>
<span class="sourceLineNo">149</span>}<a name="line.149"></a>




























































</pre>
</div>
</body>
</html>
