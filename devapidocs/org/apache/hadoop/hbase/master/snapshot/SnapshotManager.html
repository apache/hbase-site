<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (17) -->
<title>SnapshotManager (Apache HBase 4.0.0-alpha-1-SNAPSHOT API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="description" content="declaration: package: org.apache.hadoop.hbase.master.snapshot, class: SnapshotManager">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/SnapshotManager.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html#class">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field-summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li><a href="#field-detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" value="search" disabled="disabled">
<input type="reset" id="reset-button" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">org.apache.hadoop.hbase.master.snapshot</a></div>
<h1 title="Class SnapshotManager" class="title">Class SnapshotManager</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance"><a href="../../procedure/ProcedureManager.html" title="class in org.apache.hadoop.hbase.procedure">org.apache.hadoop.hbase.procedure.ProcedureManager</a>
<div class="inheritance"><a href="../../procedure/MasterProcedureManager.html" title="class in org.apache.hadoop.hbase.procedure">org.apache.hadoop.hbase.procedure.MasterProcedureManager</a>
<div class="inheritance">org.apache.hadoop.hbase.master.snapshot.SnapshotManager</div>
</div>
</div>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>All Implemented Interfaces:</dt>
<dd><code><a href="../../Stoppable.html" title="interface in org.apache.hadoop.hbase">Stoppable</a></code></dd>
</dl>
<hr>
<div class="type-signature"><span class="annotations">@LimitedPrivate("Configuration")
@Unstable
</span><span class="modifiers">public class </span><span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-126">SnapshotManager</a></span>
<span class="extends-implements">extends <a href="../../procedure/MasterProcedureManager.html" title="class in org.apache.hadoop.hbase.procedure">MasterProcedureManager</a>
implements <a href="../../Stoppable.html" title="interface in org.apache.hadoop.hbase">Stoppable</a></span></div>
<div class="block">This class manages the procedure of taking and restoring snapshots. There is only one
 SnapshotManager for the master.
 <p>
 The class provides methods for monitoring in-progress snapshot actions.
 <p>
 Note: Currently there can only be one snapshot being taken at a time over the cluster. This is a
 simplification in the current implementation.</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- =========== FIELD SUMMARY =========== -->
<li>
<section class="field-summary" id="field-summary">
<h2>Field Summary</h2>
<div class="caption"><span>Fields</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Field</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>private <a href="../../procedure/ProcedureCoordinator.html" title="class in org.apache.hadoop.hbase.procedure">ProcedureCoordinator</a></code></div>
<div class="col-second even-row-color"><code><a href="#coordinator" class="member-name-link">coordinator</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>private <a href="../../executor/ExecutorService.html" title="class in org.apache.hadoop.hbase.executor">ExecutorService</a></code></div>
<div class="col-second odd-row-color"><code><a href="#executorService" class="member-name-link">executorService</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>static final <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second even-row-color"><code><a href="#HBASE_SNAPSHOT_ENABLED" class="member-name-link">HBASE_SNAPSHOT_ENABLED</a></code></div>
<div class="col-last even-row-color">
<div class="block">Enable or disable snapshot support</div>
</div>
<div class="col-first odd-row-color"><code>static final <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second odd-row-color"><code><a href="#HBASE_SNAPSHOT_SENTINELS_CLEANUP_TIMEOUT_MILLIS" class="member-name-link">HBASE_SNAPSHOT_SENTINELS_CLEANUP_TIMEOUT_MILLIS</a></code></div>
<div class="col-last odd-row-color">
<div class="block">Wait time before removing a finished sentinel from the in-progress map NOTE: This is used as a
 safety auto cleanup.</div>
</div>
<div class="col-first even-row-color"><code>private boolean</code></div>
<div class="col-second even-row-color"><code><a href="#isSnapshotSupported" class="member-name-link">isSnapshotSupported</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>private static final org.slf4j.Logger</code></div>
<div class="col-second odd-row-color"><code><a href="#LOG" class="member-name-link">LOG</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>private <a href="../MasterServices.html" title="interface in org.apache.hadoop.hbase.master">MasterServices</a></code></div>
<div class="col-second even-row-color"><code><a href="#master" class="member-name-link">master</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>static final <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second odd-row-color"><code><a href="#ONLINE_SNAPSHOT_CONTROLLER_DESCRIPTION" class="member-name-link">ONLINE_SNAPSHOT_CONTROLLER_DESCRIPTION</a></code></div>
<div class="col-last odd-row-color">
<div class="block">Name of the operation to use in the controller</div>
</div>
<div class="col-first even-row-color"><code>private <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="../../TableName.html" title="class in org.apache.hadoop.hbase">TableName</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&gt;</code></div>
<div class="col-second even-row-color"><code><a href="#restoreTableToProcIdMap" class="member-name-link">restoreTableToProcIdMap</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>private org.apache.hadoop.fs.Path</code></div>
<div class="col-second odd-row-color"><code><a href="#rootDir" class="member-name-link">rootDir</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>private final <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/ScheduledExecutorService.html" title="class or interface in java.util.concurrent" class="external-link">ScheduledExecutorService</a></code></div>
<div class="col-second even-row-color"><code><a href="#scheduleThreadPool" class="member-name-link">scheduleThreadPool</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>static final <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second odd-row-color"><code><a href="#SNAPSHOT_MAX_FILE_SIZE_PRESERVE" class="member-name-link">SNAPSHOT_MAX_FILE_SIZE_PRESERVE</a></code></div>
<div class="col-last odd-row-color">
<div class="block">Conf key for preserving original max file size configs</div>
</div>
<div class="col-first even-row-color"><code>static final int</code></div>
<div class="col-second even-row-color"><code><a href="#SNAPSHOT_POOL_THREADS_DEFAULT" class="member-name-link">SNAPSHOT_POOL_THREADS_DEFAULT</a></code></div>
<div class="col-last even-row-color">
<div class="block">number of current operations running on the master</div>
</div>
<div class="col-first odd-row-color"><code>static final <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second odd-row-color"><code><a href="#SNAPSHOT_POOL_THREADS_KEY" class="member-name-link">SNAPSHOT_POOL_THREADS_KEY</a></code></div>
<div class="col-last odd-row-color">
<div class="block">Conf key for # of threads used by the SnapshotManager thread pool</div>
</div>
<div class="col-first even-row-color"><code>static final <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second even-row-color"><code><a href="#SNAPSHOT_PROCEDURE_ENABLED" class="member-name-link">SNAPSHOT_PROCEDURE_ENABLED</a></code></div>
<div class="col-last even-row-color">
<div class="block">Enable or disable snapshot procedure</div>
</div>
<div class="col-first odd-row-color"><code>static final boolean</code></div>
<div class="col-second odd-row-color"><code><a href="#SNAPSHOT_PROCEDURE_ENABLED_DEFAULT" class="member-name-link">SNAPSHOT_PROCEDURE_ENABLED_DEFAULT</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>static final long</code></div>
<div class="col-second even-row-color"><code><a href="#SNAPSHOT_SENTINELS_CLEANUP_TIMEOUT_MILLS_DEFAULT" class="member-name-link">SNAPSHOT_SENTINELS_CLEANUP_TIMEOUT_MILLS_DEFAULT</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>private static final int</code></div>
<div class="col-second odd-row-color"><code><a href="#SNAPSHOT_WAKE_MILLIS_DEFAULT" class="member-name-link">SNAPSHOT_WAKE_MILLIS_DEFAULT</a></code></div>
<div class="col-last odd-row-color">
<div class="block">By default, check to see if the snapshot is complete every WAKE MILLIS (ms)</div>
</div>
<div class="col-first even-row-color"><code>private static final <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second even-row-color"><code><a href="#SNAPSHOT_WAKE_MILLIS_KEY" class="member-name-link">SNAPSHOT_WAKE_MILLIS_KEY</a></code></div>
<div class="col-last even-row-color">
<div class="block">Conf key for # of ms elapsed between checks for snapshot errors while waiting for completion.</div>
</div>
<div class="col-first odd-row-color"><code>private <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/ScheduledFuture.html" title="class or interface in java.util.concurrent" class="external-link">ScheduledFuture</a>&lt;?&gt;</code></div>
<div class="col-second odd-row-color"><code><a href="#snapshotHandlerChoreCleanerTask" class="member-name-link">snapshotHandlerChoreCleanerTask</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>private final <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="../../TableName.html" title="class in org.apache.hadoop.hbase">TableName</a>,<wbr><a href="../SnapshotSentinel.html" title="interface in org.apache.hadoop.hbase.master">SnapshotSentinel</a>&gt;</code></div>
<div class="col-second even-row-color"><code><a href="#snapshotHandlers" class="member-name-link">snapshotHandlers</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>private final <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/ConcurrentHashMap.html" title="class or interface in java.util.concurrent" class="external-link">ConcurrentHashMap</a>&lt;org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription,<wbr><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&gt;</code></div>
<div class="col-second odd-row-color"><code><a href="#snapshotToProcIdMap" class="member-name-link">snapshotToProcIdMap</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>private boolean</code></div>
<div class="col-second even-row-color"><code><a href="#stopped" class="member-name-link">stopped</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>private <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/locks/ReentrantReadWriteLock.html" title="class or interface in java.util.concurrent.locks" class="external-link">ReentrantReadWriteLock</a></code></div>
<div class="col-second odd-row-color"><code><a href="#takingSnapshotLock" class="member-name-link">takingSnapshotLock</a></code></div>
<div class="col-last odd-row-color">
<div class="block">Read write lock between taking snapshot and snapshot HFile cleaner.</div>
</div>
<div class="col-first even-row-color"><code>private <a href="../WorkerAssigner.html" title="class in org.apache.hadoop.hbase.master">WorkerAssigner</a></code></div>
<div class="col-second even-row-color"><code><a href="#verifyWorkerAssigner" class="member-name-link">verifyWorkerAssigner</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
</div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E()" class="member-name-link">SnapshotManager</a>()</code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-constructor-name odd-row-color"><code><a href="#%3Cinit%3E(org.apache.hadoop.hbase.master.MasterServices,org.apache.hadoop.hbase.procedure.ProcedureCoordinator,org.apache.hadoop.hbase.executor.ExecutorService,int)" class="member-name-link">SnapshotManager</a><wbr>(<a href="../MasterServices.html" title="interface in org.apache.hadoop.hbase.master">MasterServices</a>&nbsp;master,
 <a href="../../procedure/ProcedureCoordinator.html" title="class in org.apache.hadoop.hbase.procedure">ProcedureCoordinator</a>&nbsp;coordinator,
 <a href="../../executor/ExecutorService.html" title="class in org.apache.hadoop.hbase.executor">ExecutorService</a>&nbsp;pool,
 int&nbsp;sentinelCleanInterval)</code></div>
<div class="col-last odd-row-color">
<div class="block">Fully specify all necessary components of a snapshot manager.</div>
</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab1" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab1', 3)" class="table-tab">Static Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel" aria-labelledby="method-summary-table-tab0">
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="../../ServerName.html" title="class in org.apache.hadoop.hbase">ServerName</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#acquireSnapshotVerifyWorker(org.apache.hadoop.hbase.master.procedure.SnapshotVerifyProcedure)" class="member-name-link">acquireSnapshotVerifyWorker</a><wbr>(<a href="../procedure/SnapshotVerifyProcedure.html" title="class in org.apache.hadoop.hbase.master.procedure">SnapshotVerifyProcedure</a>&nbsp;procedure)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#checkPermissions(org.apache.hadoop.hbase.shaded.protobuf.generated.HBaseProtos.ProcedureDescription,org.apache.hadoop.hbase.security.access.AccessChecker,org.apache.hadoop.hbase.security.User)" class="member-name-link">checkPermissions</a><wbr>(org.apache.hadoop.hbase.shaded.protobuf.generated.HBaseProtos.ProcedureDescription&nbsp;desc,
 <a href="../../security/access/AccessChecker.html" title="class in org.apache.hadoop.hbase.security.access">AccessChecker</a>&nbsp;accessChecker,
 <a href="../../security/User.html" title="class in org.apache.hadoop.hbase.security">User</a>&nbsp;user)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Check for required permissions before executing the procedure.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#checkSnapshotSupport()" class="member-name-link">checkSnapshotSupport</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Throws an exception if snapshot operations (take a snapshot, restore, clone) are not supported.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#checkSnapshotSupport(org.apache.hadoop.conf.Configuration,org.apache.hadoop.hbase.master.MasterFileSystem)" class="member-name-link">checkSnapshotSupport</a><wbr>(org.apache.hadoop.conf.Configuration&nbsp;conf,
 <a href="../MasterFileSystem.html" title="class in org.apache.hadoop.hbase.master">MasterFileSystem</a>&nbsp;mfs)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Called at startup, to verify if snapshot operation is supported, and to avoid starting the
 master if there're snapshots present but the cleaners needed are missing.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#cleanupCompletedRestoreInMap()" class="member-name-link">cleanupCompletedRestoreInMap</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Remove the procedures that are marked as finished</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#cleanupCompletedSnapshotInMap()" class="member-name-link">cleanupCompletedSnapshotInMap</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Remove the procedures that are marked as finished</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#cleanupSentinels()" class="member-name-link">cleanupSentinels</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Removes "abandoned" snapshot/restore requests.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#cleanupSentinels(java.util.Map)" class="member-name-link">cleanupSentinels</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="../../TableName.html" title="class in org.apache.hadoop.hbase">TableName</a>,<wbr><a href="../SnapshotSentinel.html" title="interface in org.apache.hadoop.hbase.master">SnapshotSentinel</a>&gt;&nbsp;sentinels)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Remove the sentinels that are marked as finished and the completion time has exceeded the
 removal timeout.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>(package private) long</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#cloneSnapshot(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription,org.apache.hadoop.hbase.client.TableDescriptor,org.apache.hadoop.hbase.util.NonceKey,boolean,java.lang.String)" class="member-name-link">cloneSnapshot</a><wbr>(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot,
 <a href="../../client/TableDescriptor.html" title="interface in org.apache.hadoop.hbase.client">TableDescriptor</a>&nbsp;tableDescriptor,
 <a href="../../util/NonceKey.html" title="class in org.apache.hadoop.hbase.util">NonceKey</a>&nbsp;nonceKey,
 boolean&nbsp;restoreAcl,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;customSFT)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Clone the specified snapshot into a new table.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private long</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#cloneSnapshot(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription,org.apache.hadoop.hbase.TableName,org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription,org.apache.hadoop.hbase.client.TableDescriptor,org.apache.hadoop.hbase.util.NonceKey,boolean,java.lang.String)" class="member-name-link">cloneSnapshot</a><wbr>(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;reqSnapshot,
 <a href="../../TableName.html" title="class in org.apache.hadoop.hbase">TableName</a>&nbsp;tableName,
 org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot,
 <a href="../../client/TableDescriptor.html" title="interface in org.apache.hadoop.hbase.client">TableDescriptor</a>&nbsp;snapshotTableDesc,
 <a href="../../util/NonceKey.html" title="class in org.apache.hadoop.hbase.util">NonceKey</a>&nbsp;nonceKey,
 boolean&nbsp;restoreAcl,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;customSFT)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Clone the specified snapshot.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#deleteSnapshot(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription)" class="member-name-link">deleteSnapshot</a><wbr>(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Delete the specified snapshot</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#execProcedure(org.apache.hadoop.hbase.shaded.protobuf.generated.HBaseProtos.ProcedureDescription)" class="member-name-link">execProcedure</a><wbr>(org.apache.hadoop.hbase.shaded.protobuf.generated.HBaseProtos.ProcedureDescription&nbsp;desc)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Execute a distributed procedure on cluster</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getAvailableWorker(org.apache.hadoop.hbase.ServerName)" class="member-name-link">getAvailableWorker</a><wbr>(<a href="../../ServerName.html" title="class in org.apache.hadoop.hbase">ServerName</a>&nbsp;serverName)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getCompletedSnapshots()" class="member-name-link">getCompletedSnapshots</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Gets the list of all completed snapshots.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getCompletedSnapshots(org.apache.hadoop.fs.Path,boolean)" class="member-name-link">getCompletedSnapshots</a><wbr>(org.apache.hadoop.fs.Path&nbsp;snapshotDir,
 boolean&nbsp;withCpCall)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Gets the list of all completed snapshots.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>(package private) <a href="../../procedure/ProcedureCoordinator.html" title="class in org.apache.hadoop.hbase.procedure">ProcedureCoordinator</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getCoordinator()" class="member-name-link">getCoordinator</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Returns distributed commit coordinator for all running snapshots</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getProcedureSignature()" class="member-name-link">getProcedureSignature</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Return the unique signature of the procedure.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/locks/ReadWriteLock.html" title="class or interface in java.util.concurrent.locks" class="external-link">ReadWriteLock</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getTakingSnapshotLock()" class="member-name-link">getTakingSnapshotLock</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#initialize(org.apache.hadoop.hbase.master.MasterServices,org.apache.hadoop.hbase.master.MetricsMaster)" class="member-name-link">initialize</a><wbr>(<a href="../MasterServices.html" title="interface in org.apache.hadoop.hbase.master">MasterServices</a>&nbsp;master,
 <a href="../MetricsMaster.html" title="class in org.apache.hadoop.hbase.master">MetricsMaster</a>&nbsp;metricsMaster)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Initialize a globally barriered procedure for master.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#isProcedureDone(org.apache.hadoop.hbase.shaded.protobuf.generated.HBaseProtos.ProcedureDescription)" class="member-name-link">isProcedureDone</a><wbr>(org.apache.hadoop.hbase.shaded.protobuf.generated.HBaseProtos.ProcedureDescription&nbsp;desc)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Check if the procedure is finished successfully</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#isRestoringTable(org.apache.hadoop.hbase.TableName)" class="member-name-link">isRestoringTable</a><wbr>(<a href="../../TableName.html" title="class in org.apache.hadoop.hbase">TableName</a>&nbsp;tableName)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Verify if the restore of the specified table is in progress.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#isSnapshotCompleted(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription)" class="member-name-link">isSnapshotCompleted</a><wbr>(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Check to see if the snapshot is one of the currently completed snapshots Returns true if the
 snapshot exists in the "completed snapshots folder".</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#isSnapshotDone(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription)" class="member-name-link">isSnapshotDone</a><wbr>(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;expected)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Check if the specified snapshot is done</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#isStopped()" class="member-name-link">isStopped</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Returns True if <a href="../../Stoppable.html#stop(java.lang.String)"><code>Stoppable.stop(String)</code></a> has been closed.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#isTableTakingAnySnapshot(org.apache.hadoop.hbase.TableName)" class="member-name-link">isTableTakingAnySnapshot</a><wbr>(<a href="../../TableName.html" title="class in org.apache.hadoop.hbase">TableName</a>&nbsp;tableName)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#isTakingAnySnapshot()" class="member-name-link">isTakingAnySnapshot</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">The snapshot operation processing as following: <br>
 1.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>(package private) boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#isTakingSnapshot(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription,boolean)" class="member-name-link">isTakingSnapshot</a><wbr>(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot,
 boolean&nbsp;checkTable)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Check to see if there is a snapshot in progress with the same name or on the same table.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#isTakingSnapshot(org.apache.hadoop.hbase.TableName)" class="member-name-link">isTakingSnapshot</a><wbr>(<a href="../../TableName.html" title="class in org.apache.hadoop.hbase">TableName</a>&nbsp;tableName)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Check to see if the specified table has a snapshot in progress.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#isTakingSnapshot(org.apache.hadoop.hbase.TableName,boolean)" class="member-name-link">isTakingSnapshot</a><wbr>(<a href="../../TableName.html" title="class in org.apache.hadoop.hbase">TableName</a>&nbsp;tableName,
 boolean&nbsp;checkProcedure)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Check to see if the specified table has a snapshot in progress.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#prepareWorkingDirectory(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription)" class="member-name-link">prepareWorkingDirectory</a><wbr>(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Check to make sure that we are OK to run the passed snapshot.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#registerSnapshotProcedure(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription,long)" class="member-name-link">registerSnapshotProcedure</a><wbr>(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot,
 long&nbsp;procId)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#releaseSnapshotVerifyWorker(org.apache.hadoop.hbase.master.procedure.SnapshotVerifyProcedure,org.apache.hadoop.hbase.ServerName,org.apache.hadoop.hbase.master.procedure.MasterProcedureScheduler)" class="member-name-link">releaseSnapshotVerifyWorker</a><wbr>(<a href="../procedure/SnapshotVerifyProcedure.html" title="class in org.apache.hadoop.hbase.master.procedure">SnapshotVerifyProcedure</a>&nbsp;procedure,
 <a href="../../ServerName.html" title="class in org.apache.hadoop.hbase">ServerName</a>&nbsp;worker,
 <a href="../procedure/MasterProcedureScheduler.html" title="class in org.apache.hadoop.hbase.master.procedure">MasterProcedureScheduler</a>&nbsp;scheduler)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private <a href="../SnapshotSentinel.html" title="interface in org.apache.hadoop.hbase.master">SnapshotSentinel</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#removeSentinelIfFinished(java.util.Map,org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription)" class="member-name-link">removeSentinelIfFinished</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="../../TableName.html" title="class in org.apache.hadoop.hbase">TableName</a>,<wbr><a href="../SnapshotSentinel.html" title="interface in org.apache.hadoop.hbase.master">SnapshotSentinel</a>&gt;&nbsp;sentinels,
 org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Return the handler if it is currently live and has the same snapshot target name.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#resetTempDir()" class="member-name-link">resetTempDir</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Cleans up any zk-coordinated snapshots in the snapshot/.tmp directory that were left from
 failed snapshot attempts.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>long</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#restoreOrCloneSnapshot(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription,org.apache.hadoop.hbase.util.NonceKey,boolean,java.lang.String)" class="member-name-link">restoreOrCloneSnapshot</a><wbr>(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;reqSnapshot,
 <a href="../../util/NonceKey.html" title="class in org.apache.hadoop.hbase.util">NonceKey</a>&nbsp;nonceKey,
 boolean&nbsp;restoreAcl,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;customSFT)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Restore or Clone the specified snapshot</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private long</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#restoreSnapshot(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription,org.apache.hadoop.hbase.client.TableDescriptor,org.apache.hadoop.hbase.util.NonceKey,boolean)" class="member-name-link">restoreSnapshot</a><wbr>(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot,
 <a href="../../client/TableDescriptor.html" title="interface in org.apache.hadoop.hbase.client">TableDescriptor</a>&nbsp;tableDescriptor,
 <a href="../../util/NonceKey.html" title="class in org.apache.hadoop.hbase.util">NonceKey</a>&nbsp;nonceKey,
 boolean&nbsp;restoreAcl)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Restore the specified snapshot.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private long</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#restoreSnapshot(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription,org.apache.hadoop.hbase.TableName,org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription,org.apache.hadoop.hbase.client.TableDescriptor,org.apache.hadoop.hbase.util.NonceKey,boolean)" class="member-name-link">restoreSnapshot</a><wbr>(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;reqSnapshot,
 <a href="../../TableName.html" title="class in org.apache.hadoop.hbase">TableName</a>&nbsp;tableName,
 org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot,
 <a href="../../client/TableDescriptor.html" title="interface in org.apache.hadoop.hbase.client">TableDescriptor</a>&nbsp;snapshotTableDesc,
 <a href="../../util/NonceKey.html" title="class in org.apache.hadoop.hbase.util">NonceKey</a>&nbsp;nonceKey,
 boolean&nbsp;restoreAcl)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Restore the specified snapshot.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#restoreUnfinishedSnapshotProcedure()" class="member-name-link">restoreUnfinishedSnapshotProcedure</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#restoreWorkers()" class="member-name-link">restoreWorkers</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private <a href="../../client/TableDescriptor.html" title="interface in org.apache.hadoop.hbase.client">TableDescriptor</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#sanityCheckBeforeSnapshot(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription,boolean)" class="member-name-link">sanityCheckBeforeSnapshot</a><wbr>(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot,
 boolean&nbsp;checkTable)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Check if the snapshot can be taken.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#setSnapshotHandlerForTesting(org.apache.hadoop.hbase.TableName,org.apache.hadoop.hbase.master.SnapshotSentinel)" class="member-name-link">setSnapshotHandlerForTesting</a><wbr>(<a href="../../TableName.html" title="class in org.apache.hadoop.hbase">TableName</a>&nbsp;tableName,
 <a href="../SnapshotSentinel.html" title="interface in org.apache.hadoop.hbase.master">SnapshotSentinel</a>&nbsp;handler)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Set the handler for the current snapshot</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#snapshotDisabledTable(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription)" class="member-name-link">snapshotDisabledTable</a><wbr>(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Take a snapshot of a disabled table.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#snapshotEnabledTable(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription)" class="member-name-link">snapshotEnabledTable</a><wbr>(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Take a snapshot of an enabled table.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#snapshotProcedureEnabled()" class="member-name-link">snapshotProcedureEnabled</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#snapshotTable(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription,org.apache.hadoop.hbase.master.snapshot.TakeSnapshotHandler)" class="member-name-link">snapshotTable</a><wbr>(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot,
 <a href="TakeSnapshotHandler.html" title="class in org.apache.hadoop.hbase.master.snapshot">TakeSnapshotHandler</a>&nbsp;handler)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Take a snapshot using the specified handler.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#stop(java.lang.String)" class="member-name-link">stop</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;why)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Stop this service.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private long</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#submitSnapshotProcedure(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription,long,long)" class="member-name-link">submitSnapshotProcedure</a><wbr>(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot,
 long&nbsp;nonceGroup,
 long&nbsp;nonce)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#takeSnapshot(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription)" class="member-name-link">takeSnapshot</a><wbr>(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Take a snapshot based on the enabled/disabled state of the table.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>long</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#takeSnapshot(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription,long,long)" class="member-name-link">takeSnapshot</a><wbr>(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot,
 long&nbsp;nonceGroup,
 long&nbsp;nonce)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#takeSnapshotInternal(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription)" class="member-name-link">takeSnapshotInternal</a><wbr>(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#toSnapshotDescription(org.apache.hadoop.hbase.shaded.protobuf.generated.HBaseProtos.ProcedureDescription)" class="member-name-link">toSnapshotDescription</a><wbr>(org.apache.hadoop.hbase.shaded.protobuf.generated.HBaseProtos.ProcedureDescription&nbsp;desc)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#unregisterSnapshotProcedure(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription,long)" class="member-name-link">unregisterSnapshotProcedure</a><wbr>(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot,
 long&nbsp;procId)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>private static void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#updateWorkingDirAclsIfRequired(org.apache.hadoop.fs.Path,org.apache.hadoop.fs.FileSystem)" class="member-name-link">updateWorkingDirAclsIfRequired</a><wbr>(org.apache.hadoop.fs.Path&nbsp;workingDir,
 org.apache.hadoop.fs.FileSystem&nbsp;workingDirFS)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">If the parent dir of the snapshot working dir (e.g.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-org.apache.hadoop.hbase.procedure.MasterProcedureManager">Methods inherited from class&nbsp;org.apache.hadoop.hbase.procedure.<a href="../../procedure/MasterProcedureManager.html" title="class in org.apache.hadoop.hbase.procedure">MasterProcedureManager</a></h3>
<code><a href="../../procedure/MasterProcedureManager.html#execProcedureWithRet(org.apache.hadoop.hbase.shaded.protobuf.generated.HBaseProtos.ProcedureDescription)">execProcedureWithRet</a></code></div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-org.apache.hadoop.hbase.procedure.ProcedureManager">Methods inherited from class&nbsp;org.apache.hadoop.hbase.procedure.<a href="../../procedure/ProcedureManager.html" title="class in org.apache.hadoop.hbase.procedure">ProcedureManager</a></h3>
<code><a href="../../procedure/ProcedureManager.html#equals(java.lang.Object)">equals</a>, <a href="../../procedure/ProcedureManager.html#hashCode()">hashCode</a></code></div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ FIELD DETAIL =========== -->
<li>
<section class="field-details" id="field-detail">
<h2>Field Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="LOG">
<h3>LOG</h3>
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type">org.slf4j.Logger</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-129">LOG</a></span></div>
</section>
</li>
<li>
<section class="detail" id="SNAPSHOT_WAKE_MILLIS_DEFAULT">
<h3>SNAPSHOT_WAKE_MILLIS_DEFAULT</h3>
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-132">SNAPSHOT_WAKE_MILLIS_DEFAULT</a></span></div>
<div class="block">By default, check to see if the snapshot is complete every WAKE MILLIS (ms)</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../../constant-values.html#org.apache.hadoop.hbase.master.snapshot.SnapshotManager.SNAPSHOT_WAKE_MILLIS_DEFAULT">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="HBASE_SNAPSHOT_SENTINELS_CLEANUP_TIMEOUT_MILLIS">
<h3>HBASE_SNAPSHOT_SENTINELS_CLEANUP_TIMEOUT_MILLIS</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-143">HBASE_SNAPSHOT_SENTINELS_CLEANUP_TIMEOUT_MILLIS</a></span></div>
<div class="block">Wait time before removing a finished sentinel from the in-progress map NOTE: This is used as a
 safety auto cleanup. The snapshot and restore handlers map entries are removed when a user asks
 if a snapshot or restore is completed. This operation is part of the HBaseAdmin
 snapshot/restore API flow. In case something fails on the client side and the snapshot/restore
 state is not reclaimed after a default timeout, the entry is removed from the in-progress map.
 At this point, if the user asks for the snapshot/restore status, the result will be snapshot
 done if exists or failed if it doesn't exists.</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../../constant-values.html#org.apache.hadoop.hbase.master.snapshot.SnapshotManager.HBASE_SNAPSHOT_SENTINELS_CLEANUP_TIMEOUT_MILLIS">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="SNAPSHOT_SENTINELS_CLEANUP_TIMEOUT_MILLS_DEFAULT">
<h3>SNAPSHOT_SENTINELS_CLEANUP_TIMEOUT_MILLS_DEFAULT</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type">long</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-145">SNAPSHOT_SENTINELS_CLEANUP_TIMEOUT_MILLS_DEFAULT</a></span></div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../../constant-values.html#org.apache.hadoop.hbase.master.snapshot.SnapshotManager.SNAPSHOT_SENTINELS_CLEANUP_TIMEOUT_MILLS_DEFAULT">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="HBASE_SNAPSHOT_ENABLED">
<h3>HBASE_SNAPSHOT_ENABLED</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-148">HBASE_SNAPSHOT_ENABLED</a></span></div>
<div class="block">Enable or disable snapshot support</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../../constant-values.html#org.apache.hadoop.hbase.master.snapshot.SnapshotManager.HBASE_SNAPSHOT_ENABLED">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="SNAPSHOT_WAKE_MILLIS_KEY">
<h3>SNAPSHOT_WAKE_MILLIS_KEY</h3>
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-153">SNAPSHOT_WAKE_MILLIS_KEY</a></span></div>
<div class="block">Conf key for # of ms elapsed between checks for snapshot errors while waiting for completion.</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../../constant-values.html#org.apache.hadoop.hbase.master.snapshot.SnapshotManager.SNAPSHOT_WAKE_MILLIS_KEY">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="ONLINE_SNAPSHOT_CONTROLLER_DESCRIPTION">
<h3>ONLINE_SNAPSHOT_CONTROLLER_DESCRIPTION</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-156">ONLINE_SNAPSHOT_CONTROLLER_DESCRIPTION</a></span></div>
<div class="block">Name of the operation to use in the controller</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../../constant-values.html#org.apache.hadoop.hbase.master.snapshot.SnapshotManager.ONLINE_SNAPSHOT_CONTROLLER_DESCRIPTION">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="SNAPSHOT_POOL_THREADS_KEY">
<h3>SNAPSHOT_POOL_THREADS_KEY</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-159">SNAPSHOT_POOL_THREADS_KEY</a></span></div>
<div class="block">Conf key for # of threads used by the SnapshotManager thread pool</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../../constant-values.html#org.apache.hadoop.hbase.master.snapshot.SnapshotManager.SNAPSHOT_POOL_THREADS_KEY">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="SNAPSHOT_POOL_THREADS_DEFAULT">
<h3>SNAPSHOT_POOL_THREADS_DEFAULT</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-162">SNAPSHOT_POOL_THREADS_DEFAULT</a></span></div>
<div class="block">number of current operations running on the master</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../../constant-values.html#org.apache.hadoop.hbase.master.snapshot.SnapshotManager.SNAPSHOT_POOL_THREADS_DEFAULT">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="SNAPSHOT_MAX_FILE_SIZE_PRESERVE">
<h3>SNAPSHOT_MAX_FILE_SIZE_PRESERVE</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-165">SNAPSHOT_MAX_FILE_SIZE_PRESERVE</a></span></div>
<div class="block">Conf key for preserving original max file size configs</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../../constant-values.html#org.apache.hadoop.hbase.master.snapshot.SnapshotManager.SNAPSHOT_MAX_FILE_SIZE_PRESERVE">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="SNAPSHOT_PROCEDURE_ENABLED">
<h3>SNAPSHOT_PROCEDURE_ENABLED</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-169">SNAPSHOT_PROCEDURE_ENABLED</a></span></div>
<div class="block">Enable or disable snapshot procedure</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../../constant-values.html#org.apache.hadoop.hbase.master.snapshot.SnapshotManager.SNAPSHOT_PROCEDURE_ENABLED">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="SNAPSHOT_PROCEDURE_ENABLED_DEFAULT">
<h3>SNAPSHOT_PROCEDURE_ENABLED_DEFAULT</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-171">SNAPSHOT_PROCEDURE_ENABLED_DEFAULT</a></span></div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../../constant-values.html#org.apache.hadoop.hbase.master.snapshot.SnapshotManager.SNAPSHOT_PROCEDURE_ENABLED_DEFAULT">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="stopped">
<h3>stopped</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-173">stopped</a></span></div>
</section>
</li>
<li>
<section class="detail" id="master">
<h3>master</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type"><a href="../MasterServices.html" title="interface in org.apache.hadoop.hbase.master">MasterServices</a></span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-174">master</a></span></div>
</section>
</li>
<li>
<section class="detail" id="coordinator">
<h3>coordinator</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type"><a href="../../procedure/ProcedureCoordinator.html" title="class in org.apache.hadoop.hbase.procedure">ProcedureCoordinator</a></span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-175">coordinator</a></span></div>
</section>
</li>
<li>
<section class="detail" id="isSnapshotSupported">
<h3>isSnapshotSupported</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-178">isSnapshotSupported</a></span></div>
</section>
</li>
<li>
<section class="detail" id="snapshotHandlers">
<h3>snapshotHandlers</h3>
<div class="member-signature"><span class="modifiers">private final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="../../TableName.html" title="class in org.apache.hadoop.hbase">TableName</a>,<wbr><a href="../SnapshotSentinel.html" title="interface in org.apache.hadoop.hbase.master">SnapshotSentinel</a>&gt;</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-184">snapshotHandlers</a></span></div>
</section>
</li>
<li>
<section class="detail" id="scheduleThreadPool">
<h3>scheduleThreadPool</h3>
<div class="member-signature"><span class="modifiers">private final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/ScheduledExecutorService.html" title="class or interface in java.util.concurrent" class="external-link">ScheduledExecutorService</a></span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-185">scheduleThreadPool</a></span></div>
</section>
</li>
<li>
<section class="detail" id="snapshotHandlerChoreCleanerTask">
<h3>snapshotHandlerChoreCleanerTask</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/ScheduledFuture.html" title="class or interface in java.util.concurrent" class="external-link">ScheduledFuture</a>&lt;?&gt;</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-188">snapshotHandlerChoreCleanerTask</a></span></div>
</section>
</li>
<li>
<section class="detail" id="restoreTableToProcIdMap">
<h3>restoreTableToProcIdMap</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="../../TableName.html" title="class in org.apache.hadoop.hbase">TableName</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&gt;</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-197">restoreTableToProcIdMap</a></span></div>
</section>
</li>
<li>
<section class="detail" id="snapshotToProcIdMap">
<h3>snapshotToProcIdMap</h3>
<div class="member-signature"><span class="modifiers">private final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/ConcurrentHashMap.html" title="class or interface in java.util.concurrent" class="external-link">ConcurrentHashMap</a>&lt;org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription,<wbr><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&gt;</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-200">snapshotToProcIdMap</a></span></div>
</section>
</li>
<li>
<section class="detail" id="verifyWorkerAssigner">
<h3>verifyWorkerAssigner</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type"><a href="../WorkerAssigner.html" title="class in org.apache.hadoop.hbase.master">WorkerAssigner</a></span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-203">verifyWorkerAssigner</a></span></div>
</section>
</li>
<li>
<section class="detail" id="rootDir">
<h3>rootDir</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">org.apache.hadoop.fs.Path</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-205">rootDir</a></span></div>
</section>
</li>
<li>
<section class="detail" id="executorService">
<h3>executorService</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type"><a href="../../executor/ExecutorService.html" title="class in org.apache.hadoop.hbase.executor">ExecutorService</a></span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-206">executorService</a></span></div>
</section>
</li>
<li>
<section class="detail" id="takingSnapshotLock">
<h3>takingSnapshotLock</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/locks/ReentrantReadWriteLock.html" title="class or interface in java.util.concurrent.locks" class="external-link">ReentrantReadWriteLock</a></span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-214">takingSnapshotLock</a></span></div>
<div class="block">Read write lock between taking snapshot and snapshot HFile cleaner. The cleaner should skip to
 check the HFiles if any snapshot is in progress, otherwise it may clean a HFile which would
 belongs to the newly creating snapshot. So we should grab the write lock first when cleaner
 start to work. (See HBASE-21387)</div>
</section>
</li>
</ul>
</section>
</li>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;()">
<h3>SnapshotManager</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-216">SnapshotManager</a></span>()</div>
</section>
</li>
<li>
<section class="detail" id="&lt;init&gt;(org.apache.hadoop.hbase.master.MasterServices,org.apache.hadoop.hbase.procedure.ProcedureCoordinator,org.apache.hadoop.hbase.executor.ExecutorService,int)">
<h3>SnapshotManager</h3>
<div class="member-signature"><span class="annotations">@Private
</span><span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-225">SnapshotManager</a></span><wbr><span class="parameters">(<a href="../MasterServices.html" title="interface in org.apache.hadoop.hbase.master">MasterServices</a>&nbsp;master,
 <a href="../../procedure/ProcedureCoordinator.html" title="class in org.apache.hadoop.hbase.procedure">ProcedureCoordinator</a>&nbsp;coordinator,
 <a href="../../executor/ExecutorService.html" title="class in org.apache.hadoop.hbase.executor">ExecutorService</a>&nbsp;pool,
 int&nbsp;sentinelCleanInterval)</span>
         throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a>,
<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/UnsupportedOperationException.html" title="class or interface in java.lang" class="external-link">UnsupportedOperationException</a></span></div>
<div class="block">Fully specify all necessary components of a snapshot manager. Exposed for testing.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>master</code> - services for the master where the manager is running</dd>
<dd><code>coordinator</code> - procedure coordinator instance. exposed for testing.</dd>
<dd><code>pool</code> - HBase ExecutorServcie instance, exposed for testing.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/UnsupportedOperationException.html" title="class or interface in java.lang" class="external-link">UnsupportedOperationException</a></code></dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="getCompletedSnapshots()">
<h3>getCompletedSnapshots</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&gt;</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-247">getCompletedSnapshots</a></span>()
                                                                                                                 throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Gets the list of all completed snapshots.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>list of SnapshotDescriptions</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - File system exception</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getCompletedSnapshots(org.apache.hadoop.fs.Path,boolean)">
<h3>getCompletedSnapshots</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&gt;</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-258">getCompletedSnapshots</a></span><wbr><span class="parameters">(org.apache.hadoop.fs.Path&nbsp;snapshotDir,
 boolean&nbsp;withCpCall)</span>
                                                                                                                  throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Gets the list of all completed snapshots.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>snapshotDir</code> - snapshot directory</dd>
<dd><code>withCpCall</code> - Whether to call CP hooks</dd>
<dt>Returns:</dt>
<dd>list of SnapshotDescriptions</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - File system exception</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="resetTempDir()">
<h3>resetTempDir</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-322">resetTempDir</a></span>()
                   throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Cleans up any zk-coordinated snapshots in the snapshot/.tmp directory that were left from
 failed snapshot attempts. For unfinished procedure2-coordinated snapshots, keep the working
 directory.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - if we can't reach the filesystem</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="deleteSnapshot(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription)">
<h3>deleteSnapshot</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-359">deleteSnapshot</a></span><wbr><span class="parameters">(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot)</span>
                    throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Delete the specified snapshot</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="../../snapshot/SnapshotDoesNotExistException.html" title="class in org.apache.hadoop.hbase.snapshot">SnapshotDoesNotExistException</a></code> - If the specified snapshot does not exist.</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - For filesystem IOExceptions</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="isSnapshotDone(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription)">
<h3>isSnapshotDone</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-400">isSnapshotDone</a></span><wbr><span class="parameters">(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;expected)</span>
                       throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Check if the specified snapshot is done</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>true if snapshot is ready to be restored, false if it is still being taken.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - IOException if error from HDFS or RPC</dd>
<dd><code><a href="../../snapshot/UnknownSnapshotException.html" title="class in org.apache.hadoop.hbase.snapshot">UnknownSnapshotException</a></code> - if snapshot is invalid or does not exist.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="isTakingSnapshot(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription,boolean)">
<h3>isTakingSnapshot</h3>
<div class="member-signature"><span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-475">isTakingSnapshot</a></span><wbr><span class="parameters">(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot,
 boolean&nbsp;checkTable)</span></div>
<div class="block">Check to see if there is a snapshot in progress with the same name or on the same table.
 Currently we have a limitation only allowing a single snapshot per table at a time. Also we
 don't allow snapshot with the same name.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>snapshot</code> - description of the snapshot being checked.</dd>
<dd><code>checkTable</code> - check if the table is already taking a snapshot.</dd>
<dt>Returns:</dt>
<dd><tt>true</tt> if there is a snapshot in progress with the same name or on the same
         table.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="isTakingSnapshot(org.apache.hadoop.hbase.TableName)">
<h3>isTakingSnapshot</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-509">isTakingSnapshot</a></span><wbr><span class="parameters">(<a href="../../TableName.html" title="class in org.apache.hadoop.hbase">TableName</a>&nbsp;tableName)</span></div>
<div class="block">Check to see if the specified table has a snapshot in progress. Currently we have a limitation
 only allowing a single snapshot per table at a time.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>tableName</code> - name of the table being snapshotted.</dd>
<dt>Returns:</dt>
<dd><tt>true</tt> if there is a snapshot in progress on the specified table.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="isTableTakingAnySnapshot(org.apache.hadoop.hbase.TableName)">
<h3>isTableTakingAnySnapshot</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-513">isTableTakingAnySnapshot</a></span><wbr><span class="parameters">(<a href="../../TableName.html" title="class in org.apache.hadoop.hbase">TableName</a>&nbsp;tableName)</span></div>
</section>
</li>
<li>
<section class="detail" id="isTakingSnapshot(org.apache.hadoop.hbase.TableName,boolean)">
<h3>isTakingSnapshot</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-529">isTakingSnapshot</a></span><wbr><span class="parameters">(<a href="../../TableName.html" title="class in org.apache.hadoop.hbase">TableName</a>&nbsp;tableName,
 boolean&nbsp;checkProcedure)</span></div>
<div class="block">Check to see if the specified table has a snapshot in progress. Since we introduce the
 SnapshotProcedure, it is a little bit different from before. For zk-coordinated snapshot, we
 can just consider tables in snapshotHandlers only, but for
 <a href="../assignment/MergeTableRegionsProcedure.html" title="class in org.apache.hadoop.hbase.master.assignment"><code>MergeTableRegionsProcedure</code></a> and
 <a href="../assignment/SplitTableRegionProcedure.html" title="class in org.apache.hadoop.hbase.master.assignment"><code>SplitTableRegionProcedure</code></a>, we need to
 consider tables in snapshotToProcIdMap also, for the snapshot procedure, we don't need to check
 if table in snapshot.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>tableName</code> - name of the table being snapshotted.</dd>
<dd><code>checkProcedure</code> - true if we should check tables in snapshotToProcIdMap</dd>
<dt>Returns:</dt>
<dd><tt>true</tt> if there is a snapshot in progress on the specified table.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="prepareWorkingDirectory(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription)">
<h3>prepareWorkingDirectory</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-553">prepareWorkingDirectory</a></span><wbr><span class="parameters">(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot)</span>
                             throws <span class="exceptions"><a href="../../snapshot/HBaseSnapshotException.html" title="class in org.apache.hadoop.hbase.snapshot">HBaseSnapshotException</a></span></div>
<div class="block">Check to make sure that we are OK to run the passed snapshot. Checks to make sure that we
 aren't already running a snapshot or restore on the requested table.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>snapshot</code> - description of the snapshot we want to start</dd>
<dt>Throws:</dt>
<dd><code><a href="../../snapshot/HBaseSnapshotException.html" title="class in org.apache.hadoop.hbase.snapshot">HBaseSnapshotException</a></code> - if the filesystem could not be prepared to start the snapshot</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="updateWorkingDirAclsIfRequired(org.apache.hadoop.fs.Path,org.apache.hadoop.fs.FileSystem)">
<h3>updateWorkingDirAclsIfRequired</h3>
<div class="member-signature"><span class="modifiers">private static</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-589">updateWorkingDirAclsIfRequired</a></span><wbr><span class="parameters">(org.apache.hadoop.fs.Path&nbsp;workingDir,
 org.apache.hadoop.fs.FileSystem&nbsp;workingDirFS)</span>
                                            throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">If the parent dir of the snapshot working dir (e.g. /hbase/.hbase-snapshot) has non-empty ACLs,
 use them for the current working dir (e.g. /hbase/.hbase-snapshot/.tmp/{snapshot-name}) so that
 regardless of whether the snapshot commit phase performs atomic rename or non-atomic copy of
 the working dir to new snapshot dir, the ACLs are retained.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>workingDir</code> - working dir to build the snapshot.</dd>
<dd><code>workingDirFS</code> - working dir file system.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - If ACL read/modify operation fails.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="snapshotDisabledTable(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription)">
<h3>snapshotDisabledTable</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-622">snapshotDisabledTable</a></span><wbr><span class="parameters">(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot)</span>
                            throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Take a snapshot of a disabled table.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>snapshot</code> - description of the snapshot to take. Modified to be <code>SnapshotProtos.SnapshotDescription.Type.DISABLED</code>.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - if the snapshot could not be started or filesystem for snapshot temporary
                     directory could not be determined</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="snapshotEnabledTable(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription)">
<h3>snapshotEnabledTable</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-640">snapshotEnabledTable</a></span><wbr><span class="parameters">(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot)</span>
                           throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Take a snapshot of an enabled table.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>snapshot</code> - description of the snapshot to take.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - if the snapshot could not be started or filesystem for snapshot temporary
                     directory could not be determined</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="snapshotTable(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription,org.apache.hadoop.hbase.master.snapshot.TakeSnapshotHandler)">
<h3>snapshotTable</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-656">snapshotTable</a></span><wbr><span class="parameters">(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot,
 <a href="TakeSnapshotHandler.html" title="class in org.apache.hadoop.hbase.master.snapshot">TakeSnapshotHandler</a>&nbsp;handler)</span>
                    throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Take a snapshot using the specified handler. On failure the snapshot temporary working
 directory is removed. NOTE: prepareToTakeSnapshot() called before this one takes care of the
 rejecting the snapshot request if the table is busy with another snapshot/restore operation.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>snapshot</code> - the snapshot description</dd>
<dd><code>handler</code> - the snapshot handler</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getTakingSnapshotLock()">
<h3>getTakingSnapshotLock</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/locks/ReadWriteLock.html" title="class or interface in java.util.concurrent.locks" class="external-link">ReadWriteLock</a></span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-682">getTakingSnapshotLock</a></span>()</div>
</section>
</li>
<li>
<section class="detail" id="isTakingAnySnapshot()">
<h3>isTakingAnySnapshot</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-694">isTakingAnySnapshot</a></span>()</div>
<div class="block">The snapshot operation processing as following: <br>
 1. Create a Snapshot Handler, and do some initialization; <br>
 2. Put the handler into snapshotHandlers <br>
 So when we consider if any snapshot is taking, we should consider both the takingSnapshotLock
 and snapshotHandlers;</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>true to indicate that there're some running snapshots.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="takeSnapshot(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription)">
<h3>takeSnapshot</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-704">takeSnapshot</a></span><wbr><span class="parameters">(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot)</span>
                  throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Take a snapshot based on the enabled/disabled state of the table.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="../../snapshot/HBaseSnapshotException.html" title="class in org.apache.hadoop.hbase.snapshot">HBaseSnapshotException</a></code> - when a snapshot specific exception occurs.</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - when some sort of generic IO exception occurs.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="takeSnapshot(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription,long,long)">
<h3>takeSnapshot</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">long</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-713">takeSnapshot</a></span><wbr><span class="parameters">(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot,
 long&nbsp;nonceGroup,
 long&nbsp;nonce)</span>
                  throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="submitSnapshotProcedure(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription,long,long)">
<h3>submitSnapshotProcedure</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">long</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-723">submitSnapshotProcedure</a></span><wbr><span class="parameters">(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot,
 long&nbsp;nonceGroup,
 long&nbsp;nonce)</span>
                              throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="takeSnapshotInternal(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription)">
<h3>takeSnapshotInternal</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-744">takeSnapshotInternal</a></span><wbr><span class="parameters">(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot)</span>
                           throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="sanityCheckBeforeSnapshot(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription,boolean)">
<h3>sanityCheckBeforeSnapshot</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type"><a href="../../client/TableDescriptor.html" title="interface in org.apache.hadoop.hbase.client">TableDescriptor</a></span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-802">sanityCheckBeforeSnapshot</a></span><wbr><span class="parameters">(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot,
 boolean&nbsp;checkTable)</span>
                                           throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Check if the snapshot can be taken. Currently we have some limitations, for zk-coordinated
 snapshot, we don't allow snapshot with same name or taking multiple snapshots of a table at the
 same time, for procedure-coordinated snapshot, we don't allow snapshot with same name.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>snapshot</code> - description of the snapshot being checked.</dd>
<dd><code>checkTable</code> - check if the table is already taking a snapshot. For zk-coordinated snapshot,
                   we need to check if another zk-coordinated snapshot is in progress, for the
                   snapshot procedure, this is unnecessary.</dd>
<dt>Returns:</dt>
<dd>the table descriptor of the table</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setSnapshotHandlerForTesting(org.apache.hadoop.hbase.TableName,org.apache.hadoop.hbase.master.SnapshotSentinel)">
<h3>setSnapshotHandlerForTesting</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-859">setSnapshotHandlerForTesting</a></span><wbr><span class="parameters">(<a href="../../TableName.html" title="class in org.apache.hadoop.hbase">TableName</a>&nbsp;tableName,
 <a href="../SnapshotSentinel.html" title="interface in org.apache.hadoop.hbase.master">SnapshotSentinel</a>&nbsp;handler)</span></div>
<div class="block">Set the handler for the current snapshot
 <p>
 Exposed for TESTING</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>handler</code> - handler the master should use TODO get rid of this if possible, repackaging,
                modify tests.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getCoordinator()">
<h3>getCoordinator</h3>
<div class="member-signature"><span class="return-type"><a href="../../procedure/ProcedureCoordinator.html" title="class in org.apache.hadoop.hbase.procedure">ProcedureCoordinator</a></span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-869">getCoordinator</a></span>()</div>
<div class="block">Returns distributed commit coordinator for all running snapshots</div>
</section>
</li>
<li>
<section class="detail" id="isSnapshotCompleted(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription)">
<h3>isSnapshotCompleted</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-882">isSnapshotCompleted</a></span><wbr><span class="parameters">(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot)</span>
                             throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Check to see if the snapshot is one of the currently completed snapshots Returns true if the
 snapshot exists in the "completed snapshots folder".</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>snapshot</code> - expected snapshot to check</dd>
<dt>Returns:</dt>
<dd><tt>true</tt> if the snapshot is stored on the <code>FileSystem</code>, <tt>false</tt> if is
         not stored</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - if the filesystem throws an unexpected exception,</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if snapshot name is invalid.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="cloneSnapshot(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription,org.apache.hadoop.hbase.TableName,org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription,org.apache.hadoop.hbase.client.TableDescriptor,org.apache.hadoop.hbase.util.NonceKey,boolean,java.lang.String)">
<h3>cloneSnapshot</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">long</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-903">cloneSnapshot</a></span><wbr><span class="parameters">(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;reqSnapshot,
 <a href="../../TableName.html" title="class in org.apache.hadoop.hbase">TableName</a>&nbsp;tableName,
 org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot,
 <a href="../../client/TableDescriptor.html" title="interface in org.apache.hadoop.hbase.client">TableDescriptor</a>&nbsp;snapshotTableDesc,
 <a href="../../util/NonceKey.html" title="class in org.apache.hadoop.hbase.util">NonceKey</a>&nbsp;nonceKey,
 boolean&nbsp;restoreAcl,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;customSFT)</span>
                    throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Clone the specified snapshot. The clone will fail if the destination table has a snapshot or
 restore in progress.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>reqSnapshot</code> - Snapshot Descriptor from request</dd>
<dd><code>tableName</code> - table to clone</dd>
<dd><code>snapshot</code> - Snapshot Descriptor</dd>
<dd><code>snapshotTableDesc</code> - Table Descriptor</dd>
<dd><code>nonceKey</code> - unique identifier to prevent duplicated RPC</dd>
<dt>Returns:</dt>
<dd>procId the ID of the clone snapshot procedure</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="cloneSnapshot(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription,org.apache.hadoop.hbase.client.TableDescriptor,org.apache.hadoop.hbase.util.NonceKey,boolean,java.lang.String)">
<h3>cloneSnapshot</h3>
<div class="member-signature"><span class="return-type">long</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-937">cloneSnapshot</a></span><wbr><span class="parameters">(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot,
 <a href="../../client/TableDescriptor.html" title="interface in org.apache.hadoop.hbase.client">TableDescriptor</a>&nbsp;tableDescriptor,
 <a href="../../util/NonceKey.html" title="class in org.apache.hadoop.hbase.util">NonceKey</a>&nbsp;nonceKey,
 boolean&nbsp;restoreAcl,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;customSFT)</span>
            throws <span class="exceptions"><a href="../../snapshot/HBaseSnapshotException.html" title="class in org.apache.hadoop.hbase.snapshot">HBaseSnapshotException</a></span></div>
<div class="block">Clone the specified snapshot into a new table. The operation will fail if the destination table
 has a snapshot or restore in progress.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>snapshot</code> - Snapshot Descriptor</dd>
<dd><code>tableDescriptor</code> - Table Descriptor of the table to create</dd>
<dd><code>nonceKey</code> - unique identifier to prevent duplicated RPC</dd>
<dt>Returns:</dt>
<dd>procId the ID of the clone snapshot procedure</dd>
<dt>Throws:</dt>
<dd><code><a href="../../snapshot/HBaseSnapshotException.html" title="class in org.apache.hadoop.hbase.snapshot">HBaseSnapshotException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="restoreOrCloneSnapshot(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription,org.apache.hadoop.hbase.util.NonceKey,boolean,java.lang.String)">
<h3>restoreOrCloneSnapshot</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">long</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-971">restoreOrCloneSnapshot</a></span><wbr><span class="parameters">(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;reqSnapshot,
 <a href="../../util/NonceKey.html" title="class in org.apache.hadoop.hbase.util">NonceKey</a>&nbsp;nonceKey,
 boolean&nbsp;restoreAcl,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;customSFT)</span>
                            throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Restore or Clone the specified snapshot</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>nonceKey</code> - unique identifier to prevent duplicated RPC</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="restoreSnapshot(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription,org.apache.hadoop.hbase.TableName,org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription,org.apache.hadoop.hbase.client.TableDescriptor,org.apache.hadoop.hbase.util.NonceKey,boolean)">
<h3>restoreSnapshot</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">long</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-1023">restoreSnapshot</a></span><wbr><span class="parameters">(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;reqSnapshot,
 <a href="../../TableName.html" title="class in org.apache.hadoop.hbase">TableName</a>&nbsp;tableName,
 org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot,
 <a href="../../client/TableDescriptor.html" title="interface in org.apache.hadoop.hbase.client">TableDescriptor</a>&nbsp;snapshotTableDesc,
 <a href="../../util/NonceKey.html" title="class in org.apache.hadoop.hbase.util">NonceKey</a>&nbsp;nonceKey,
 boolean&nbsp;restoreAcl)</span>
                      throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Restore the specified snapshot. The restore will fail if the destination table has a snapshot
 or restore in progress.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>reqSnapshot</code> - Snapshot Descriptor from request</dd>
<dd><code>tableName</code> - table to restore</dd>
<dd><code>snapshot</code> - Snapshot Descriptor</dd>
<dd><code>snapshotTableDesc</code> - Table Descriptor</dd>
<dd><code>nonceKey</code> - unique identifier to prevent duplicated RPC</dd>
<dd><code>restoreAcl</code> - true to restore acl of snapshot</dd>
<dt>Returns:</dt>
<dd>procId the ID of the restore snapshot procedure</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="restoreSnapshot(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription,org.apache.hadoop.hbase.client.TableDescriptor,org.apache.hadoop.hbase.util.NonceKey,boolean)">
<h3>restoreSnapshot</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">long</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-1073">restoreSnapshot</a></span><wbr><span class="parameters">(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot,
 <a href="../../client/TableDescriptor.html" title="interface in org.apache.hadoop.hbase.client">TableDescriptor</a>&nbsp;tableDescriptor,
 <a href="../../util/NonceKey.html" title="class in org.apache.hadoop.hbase.util">NonceKey</a>&nbsp;nonceKey,
 boolean&nbsp;restoreAcl)</span>
                      throws <span class="exceptions"><a href="../../snapshot/HBaseSnapshotException.html" title="class in org.apache.hadoop.hbase.snapshot">HBaseSnapshotException</a></span></div>
<div class="block">Restore the specified snapshot. The restore will fail if the destination table has a snapshot
 or restore in progress.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>snapshot</code> - Snapshot Descriptor</dd>
<dd><code>tableDescriptor</code> - Table Descriptor</dd>
<dd><code>nonceKey</code> - unique identifier to prevent duplicated RPC</dd>
<dd><code>restoreAcl</code> - true to restore acl of snapshot</dd>
<dt>Returns:</dt>
<dd>procId the ID of the restore snapshot procedure</dd>
<dt>Throws:</dt>
<dd><code><a href="../../snapshot/HBaseSnapshotException.html" title="class in org.apache.hadoop.hbase.snapshot">HBaseSnapshotException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="isRestoringTable(org.apache.hadoop.hbase.TableName)">
<h3>isRestoringTable</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-1109">isRestoringTable</a></span><wbr><span class="parameters">(<a href="../../TableName.html" title="class in org.apache.hadoop.hbase">TableName</a>&nbsp;tableName)</span></div>
<div class="block">Verify if the restore of the specified table is in progress.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>tableName</code> - table under restore</dd>
<dt>Returns:</dt>
<dd><tt>true</tt> if there is a restore in progress of the specified table.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="removeSentinelIfFinished(java.util.Map,org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription)">
<h3>removeSentinelIfFinished</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type"><a href="../SnapshotSentinel.html" title="interface in org.apache.hadoop.hbase.master">SnapshotSentinel</a></span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-1130">removeSentinelIfFinished</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="../../TableName.html" title="class in org.apache.hadoop.hbase">TableName</a>,<wbr><a href="../SnapshotSentinel.html" title="interface in org.apache.hadoop.hbase.master">SnapshotSentinel</a>&gt;&nbsp;sentinels,
 org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot)</span></div>
<div class="block">Return the handler if it is currently live and has the same snapshot target name. The handler
 is removed from the sentinels map if completed.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>sentinels</code> - live handlers</dd>
<dd><code>snapshot</code> - snapshot description</dd>
<dt>Returns:</dt>
<dd>null if doesn't match, else a live handler.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="cleanupSentinels()">
<h3>cleanupSentinels</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-1162">cleanupSentinels</a></span>()</div>
<div class="block">Removes "abandoned" snapshot/restore requests. As part of the HBaseAdmin snapshot/restore API
 the operation status is checked until completed, and the in-progress maps are cleaned up when
 the status of a completed task is requested. To avoid having sentinels staying around for long
 time if something client side is failed, each operation tries to clean up the in-progress maps
 sentinels finished from a long time.</div>
</section>
</li>
<li>
<section class="detail" id="cleanupSentinels(java.util.Map)">
<h3>cleanupSentinels</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-1173">cleanupSentinels</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="../../TableName.html" title="class in org.apache.hadoop.hbase">TableName</a>,<wbr><a href="../SnapshotSentinel.html" title="interface in org.apache.hadoop.hbase.master">SnapshotSentinel</a>&gt;&nbsp;sentinels)</span></div>
<div class="block">Remove the sentinels that are marked as finished and the completion time has exceeded the
 removal timeout.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>sentinels</code> - map of sentinels to clean</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="cleanupCompletedRestoreInMap()">
<h3>cleanupCompletedRestoreInMap</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-1194">cleanupCompletedRestoreInMap</a></span>()</div>
<div class="block">Remove the procedures that are marked as finished</div>
</section>
</li>
<li>
<section class="detail" id="cleanupCompletedSnapshotInMap()">
<h3>cleanupCompletedSnapshotInMap</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-1209">cleanupCompletedSnapshotInMap</a></span>()</div>
<div class="block">Remove the procedures that are marked as finished</div>
</section>
</li>
<li>
<section class="detail" id="stop(java.lang.String)">
<h3>stop</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-1225">stop</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;why)</span></div>
<div class="block"><span class="descfrm-type-label">Description copied from interface:&nbsp;<code><a href="../../Stoppable.html#stop(java.lang.String)">Stoppable</a></code></span></div>
<div class="block">Stop this service. Implementers should favor logging errors over throwing RuntimeExceptions.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="../../Stoppable.html#stop(java.lang.String)">stop</a></code>&nbsp;in interface&nbsp;<code><a href="../../Stoppable.html" title="interface in org.apache.hadoop.hbase">Stoppable</a></code></dd>
<dt>Parameters:</dt>
<dd><code>why</code> - Why we're stopping.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="isStopped()">
<h3>isStopped</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-1247">isStopped</a></span>()</div>
<div class="block"><span class="descfrm-type-label">Description copied from interface:&nbsp;<code><a href="../../Stoppable.html#isStopped()">Stoppable</a></code></span></div>
<div class="block">Returns True if <a href="../../Stoppable.html#stop(java.lang.String)"><code>Stoppable.stop(String)</code></a> has been closed.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="../../Stoppable.html#isStopped()">isStopped</a></code>&nbsp;in interface&nbsp;<code><a href="../../Stoppable.html" title="interface in org.apache.hadoop.hbase">Stoppable</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="checkSnapshotSupport()">
<h3>checkSnapshotSupport</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-1257">checkSnapshotSupport</a></span>()
                          throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/UnsupportedOperationException.html" title="class or interface in java.lang" class="external-link">UnsupportedOperationException</a></span></div>
<div class="block">Throws an exception if snapshot operations (take a snapshot, restore, clone) are not supported.
 Called at the beginning of snapshot() and restoreSnapshot() methods.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/UnsupportedOperationException.html" title="class or interface in java.lang" class="external-link">UnsupportedOperationException</a></code> - if snapshot are not supported</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="checkSnapshotSupport(org.apache.hadoop.conf.Configuration,org.apache.hadoop.hbase.master.MasterFileSystem)">
<h3>checkSnapshotSupport</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-1275">checkSnapshotSupport</a></span><wbr><span class="parameters">(org.apache.hadoop.conf.Configuration&nbsp;conf,
 <a href="../MasterFileSystem.html" title="class in org.apache.hadoop.hbase.master">MasterFileSystem</a>&nbsp;mfs)</span>
                           throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a>,
<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/UnsupportedOperationException.html" title="class or interface in java.lang" class="external-link">UnsupportedOperationException</a></span></div>
<div class="block">Called at startup, to verify if snapshot operation is supported, and to avoid starting the
 master if there're snapshots present but the cleaners needed are missing. Otherwise we can end
 up with snapshot data loss.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>conf</code> - The <code>Configuration</code> object to use</dd>
<dd><code>mfs</code> - The MasterFileSystem to use</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - in case of file-system operation failure</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/UnsupportedOperationException.html" title="class or interface in java.lang" class="external-link">UnsupportedOperationException</a></code> - in case cleaners are missing and there're snapshot in the
                                       system</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="initialize(org.apache.hadoop.hbase.master.MasterServices,org.apache.hadoop.hbase.master.MetricsMaster)">
<h3>initialize</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-1353">initialize</a></span><wbr><span class="parameters">(<a href="../MasterServices.html" title="interface in org.apache.hadoop.hbase.master">MasterServices</a>&nbsp;master,
 <a href="../MetricsMaster.html" title="class in org.apache.hadoop.hbase.master">MetricsMaster</a>&nbsp;metricsMaster)</span>
                throws <span class="exceptions">org.apache.zookeeper.KeeperException,
<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a>,
<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/UnsupportedOperationException.html" title="class or interface in java.lang" class="external-link">UnsupportedOperationException</a></span></div>
<div class="block"><span class="descfrm-type-label">Description copied from class:&nbsp;<code><a href="../../procedure/MasterProcedureManager.html#initialize(org.apache.hadoop.hbase.master.MasterServices,org.apache.hadoop.hbase.master.MetricsMaster)">MasterProcedureManager</a></code></span></div>
<div class="block">Initialize a globally barriered procedure for master.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="../../procedure/MasterProcedureManager.html#initialize(org.apache.hadoop.hbase.master.MasterServices,org.apache.hadoop.hbase.master.MetricsMaster)">initialize</a></code>&nbsp;in class&nbsp;<code><a href="../../procedure/MasterProcedureManager.html" title="class in org.apache.hadoop.hbase.procedure">MasterProcedureManager</a></code></dd>
<dt>Parameters:</dt>
<dd><code>master</code> - Master service interface</dd>
<dt>Throws:</dt>
<dd><code>org.apache.zookeeper.KeeperException</code></dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/UnsupportedOperationException.html" title="class or interface in java.lang" class="external-link">UnsupportedOperationException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="restoreUnfinishedSnapshotProcedure()">
<h3>restoreUnfinishedSnapshotProcedure</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-1389">restoreUnfinishedSnapshotProcedure</a></span>()</div>
</section>
</li>
<li>
<section class="detail" id="getProcedureSignature()">
<h3>getProcedureSignature</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-1398">getProcedureSignature</a></span>()</div>
<div class="block"><span class="descfrm-type-label">Description copied from class:&nbsp;<code><a href="../../procedure/ProcedureManager.html#getProcedureSignature()">ProcedureManager</a></code></span></div>
<div class="block">Return the unique signature of the procedure. This signature uniquely identifies the procedure.
 By default, this signature is the string used in the procedure controller (i.e., the root ZK
 node name for the procedure)</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="../../procedure/ProcedureManager.html#getProcedureSignature()">getProcedureSignature</a></code>&nbsp;in class&nbsp;<code><a href="../../procedure/ProcedureManager.html" title="class in org.apache.hadoop.hbase.procedure">ProcedureManager</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="execProcedure(org.apache.hadoop.hbase.shaded.protobuf.generated.HBaseProtos.ProcedureDescription)">
<h3>execProcedure</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-1403">execProcedure</a></span><wbr><span class="parameters">(org.apache.hadoop.hbase.shaded.protobuf.generated.HBaseProtos.ProcedureDescription&nbsp;desc)</span>
                   throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block"><span class="descfrm-type-label">Description copied from class:&nbsp;<code><a href="../../procedure/MasterProcedureManager.html#execProcedure(org.apache.hadoop.hbase.shaded.protobuf.generated.HBaseProtos.ProcedureDescription)">MasterProcedureManager</a></code></span></div>
<div class="block">Execute a distributed procedure on cluster</div>
<dl class="notes">
<dt>Overrides:</dt>
<dd><code><a href="../../procedure/MasterProcedureManager.html#execProcedure(org.apache.hadoop.hbase.shaded.protobuf.generated.HBaseProtos.ProcedureDescription)">execProcedure</a></code>&nbsp;in class&nbsp;<code><a href="../../procedure/MasterProcedureManager.html" title="class in org.apache.hadoop.hbase.procedure">MasterProcedureManager</a></code></dd>
<dt>Parameters:</dt>
<dd><code>desc</code> - Procedure description</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="checkPermissions(org.apache.hadoop.hbase.shaded.protobuf.generated.HBaseProtos.ProcedureDescription,org.apache.hadoop.hbase.security.access.AccessChecker,org.apache.hadoop.hbase.security.User)">
<h3>checkPermissions</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-1408">checkPermissions</a></span><wbr><span class="parameters">(org.apache.hadoop.hbase.shaded.protobuf.generated.HBaseProtos.ProcedureDescription&nbsp;desc,
 <a href="../../security/access/AccessChecker.html" title="class in org.apache.hadoop.hbase.security.access">AccessChecker</a>&nbsp;accessChecker,
 <a href="../../security/User.html" title="class in org.apache.hadoop.hbase.security">User</a>&nbsp;user)</span>
                      throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block"><span class="descfrm-type-label">Description copied from class:&nbsp;<code><a href="../../procedure/MasterProcedureManager.html#checkPermissions(org.apache.hadoop.hbase.shaded.protobuf.generated.HBaseProtos.ProcedureDescription,org.apache.hadoop.hbase.security.access.AccessChecker,org.apache.hadoop.hbase.security.User)">MasterProcedureManager</a></code></span></div>
<div class="block">Check for required permissions before executing the procedure.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="../../procedure/MasterProcedureManager.html#checkPermissions(org.apache.hadoop.hbase.shaded.protobuf.generated.HBaseProtos.ProcedureDescription,org.apache.hadoop.hbase.security.access.AccessChecker,org.apache.hadoop.hbase.security.User)">checkPermissions</a></code>&nbsp;in class&nbsp;<code><a href="../../procedure/MasterProcedureManager.html" title="class in org.apache.hadoop.hbase.procedure">MasterProcedureManager</a></code></dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - if permissions requirements are not met.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="isProcedureDone(org.apache.hadoop.hbase.shaded.protobuf.generated.HBaseProtos.ProcedureDescription)">
<h3>isProcedureDone</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-1415">isProcedureDone</a></span><wbr><span class="parameters">(org.apache.hadoop.hbase.shaded.protobuf.generated.HBaseProtos.ProcedureDescription&nbsp;desc)</span>
                        throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block"><span class="descfrm-type-label">Description copied from class:&nbsp;<code><a href="../../procedure/MasterProcedureManager.html#isProcedureDone(org.apache.hadoop.hbase.shaded.protobuf.generated.HBaseProtos.ProcedureDescription)">MasterProcedureManager</a></code></span></div>
<div class="block">Check if the procedure is finished successfully</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="../../procedure/MasterProcedureManager.html#isProcedureDone(org.apache.hadoop.hbase.shaded.protobuf.generated.HBaseProtos.ProcedureDescription)">isProcedureDone</a></code>&nbsp;in class&nbsp;<code><a href="../../procedure/MasterProcedureManager.html" title="class in org.apache.hadoop.hbase.procedure">MasterProcedureManager</a></code></dd>
<dt>Parameters:</dt>
<dd><code>desc</code> - Procedure description</dd>
<dt>Returns:</dt>
<dd>true if the specified procedure is finished successfully</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="toSnapshotDescription(org.apache.hadoop.hbase.shaded.protobuf.generated.HBaseProtos.ProcedureDescription)">
<h3>toSnapshotDescription</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-1420">toSnapshotDescription</a></span><wbr><span class="parameters">(org.apache.hadoop.hbase.shaded.protobuf.generated.HBaseProtos.ProcedureDescription&nbsp;desc)</span>
                                                                                                            throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="registerSnapshotProcedure(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription,long)">
<h3>registerSnapshotProcedure</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-1443">registerSnapshotProcedure</a></span><wbr><span class="parameters">(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot,
 long&nbsp;procId)</span></div>
</section>
</li>
<li>
<section class="detail" id="unregisterSnapshotProcedure(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription,long)">
<h3>unregisterSnapshotProcedure</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-1449">unregisterSnapshotProcedure</a></span><wbr><span class="parameters">(org.apache.hadoop.hbase.shaded.protobuf.generated.SnapshotProtos.SnapshotDescription&nbsp;snapshot,
 long&nbsp;procId)</span></div>
</section>
</li>
<li>
<section class="detail" id="snapshotProcedureEnabled()">
<h3>snapshotProcedureEnabled</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-1455">snapshotProcedureEnabled</a></span>()</div>
</section>
</li>
<li>
<section class="detail" id="acquireSnapshotVerifyWorker(org.apache.hadoop.hbase.master.procedure.SnapshotVerifyProcedure)">
<h3>acquireSnapshotVerifyWorker</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="../../ServerName.html" title="class in org.apache.hadoop.hbase">ServerName</a></span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-1460">acquireSnapshotVerifyWorker</a></span><wbr><span class="parameters">(<a href="../procedure/SnapshotVerifyProcedure.html" title="class in org.apache.hadoop.hbase.master.procedure">SnapshotVerifyProcedure</a>&nbsp;procedure)</span>
                                       throws <span class="exceptions"><a href="../../procedure2/ProcedureSuspendedException.html" title="class in org.apache.hadoop.hbase.procedure2">ProcedureSuspendedException</a></span></div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="../../procedure2/ProcedureSuspendedException.html" title="class in org.apache.hadoop.hbase.procedure2">ProcedureSuspendedException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="releaseSnapshotVerifyWorker(org.apache.hadoop.hbase.master.procedure.SnapshotVerifyProcedure,org.apache.hadoop.hbase.ServerName,org.apache.hadoop.hbase.master.procedure.MasterProcedureScheduler)">
<h3>releaseSnapshotVerifyWorker</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-1471">releaseSnapshotVerifyWorker</a></span><wbr><span class="parameters">(<a href="../procedure/SnapshotVerifyProcedure.html" title="class in org.apache.hadoop.hbase.master.procedure">SnapshotVerifyProcedure</a>&nbsp;procedure,
 <a href="../../ServerName.html" title="class in org.apache.hadoop.hbase">ServerName</a>&nbsp;worker,
 <a href="../procedure/MasterProcedureScheduler.html" title="class in org.apache.hadoop.hbase.master.procedure">MasterProcedureScheduler</a>&nbsp;scheduler)</span></div>
</section>
</li>
<li>
<section class="detail" id="restoreWorkers()">
<h3>restoreWorkers</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-1478">restoreWorkers</a></span>()</div>
</section>
</li>
<li>
<section class="detail" id="getAvailableWorker(org.apache.hadoop.hbase.ServerName)">
<h3>getAvailableWorker</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a></span>&nbsp;<span class="element-name"><a href="../../../../../../src-html/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.html#line-1487">getAvailableWorker</a></span><wbr><span class="parameters">(<a href="../../ServerName.html" title="class in org.apache.hadoop.hbase">ServerName</a>&nbsp;serverName)</span></div>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Copyright &#169; 2007&#x2013;2020 <a href="https://www.apache.org/">The Apache Software Foundation</a>. All rights reserved.</small></p>
</footer>
</div>
</div>
</body>
</html>
